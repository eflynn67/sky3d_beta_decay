\hypertarget{namespacetrivial}{}\doxysubsection{trivial Module Reference}
\label{namespacetrivial}\index{trivial@{trivial}}


This module contains some basic calculations with wave functions and densities, which are similar enough to be grouped together.  


\doxysubsubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
pure subroutine \mbox{\hyperlink{namespacetrivial_ad99e2ba23bf3a8e32808a945931932dc}{cmulx}} (xmat, pinn, pout, ifadd)
\begin{DoxyCompactList}\small\item\em The routine does a matrix multiplication of a real matrix with a complex wave function along the x-\/direction. {\ttfamily ifadd} allows accumulating results but is not used in the present code. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacetrivial_ac100e58f8f8789ec83e5f8621f510601}{cmuly}} (ymat, pinn, pout, ifadd)
\begin{DoxyCompactList}\small\item\em The routine does a matrix multiplication of a real matrix with a complex wave function along the y-\/direction. {\ttfamily ifadd} allows accumulating results but is not used in the present code. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacetrivial_a243661d8508f72313a919706a2c26625}{cmulz}} (zmat, pinn, pout, ifadd)
\begin{DoxyCompactList}\small\item\em The routine does a matrix multiplication of a real matrix with a complex wave function along the z-\/direction. {\ttfamily ifadd} allows accumulating results but is not used in the present code. \end{DoxyCompactList}\item 
pure real(db) function \mbox{\hyperlink{namespacetrivial_a34769580d54109e0070186feb150dfc0}{rpsnorm}} (ps)
\begin{DoxyCompactList}\small\item\em This function with one argument calculates the norm of a wave function. \end{DoxyCompactList}\item 
pure complex(db) function \mbox{\hyperlink{namespacetrivial_a3f458ad8429d9bc562bbbd15095bed75}{overlap}} (pl, pr)
\begin{DoxyCompactList}\small\item\em This calculates the overlap of two wave functions $ psi_L $ and $ psi_R $. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacetrivial_a709f609007f308ec3ef3228f0d9c9096}{rmulx}} (xmat, finn, fout, ifadd)
\begin{DoxyCompactList}\small\item\em The routine does a matrix multiplication of a real matrix with a real field along the x-\/direction. {\ttfamily ifadd} allows accumulating or substracting results. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacetrivial_ac00c799e850a49fb3288523658177649}{rmuly}} (ymat, finn, fout, ifadd)
\begin{DoxyCompactList}\small\item\em The routine does a matrix multiplication of a real matrix with a real field along the y-\/direction. {\ttfamily ifadd} allows accumulating or substracting results. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacetrivial_afd24333775edb22cf43e7c1c17c4523f}{rmulz}} (zmat, finn, fout, ifadd)
\begin{DoxyCompactList}\small\item\em The routine does a matrix multiplication of a real matrix with a real field along the z-\/direction. {\ttfamily ifadd} allows accumulating or substracting results. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
This module contains some basic calculations with wave functions and densities, which are similar enough to be grouped together. 

\doxysubsubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacetrivial_ad99e2ba23bf3a8e32808a945931932dc}\label{namespacetrivial_ad99e2ba23bf3a8e32808a945931932dc}} 
\index{trivial@{trivial}!cmulx@{cmulx}}
\index{cmulx@{cmulx}!trivial@{trivial}}
\doxyparagraph{\texorpdfstring{cmulx()}{cmulx()}}
{\footnotesize\ttfamily pure subroutine trivial\+::cmulx (\begin{DoxyParamCaption}\item[{real(db), dimension(\+:,\+:), intent(in)}]{xmat,  }\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(in)}]{pinn,  }\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(inout)}]{pout,  }\item[{integer, intent(in)}]{ifadd }\end{DoxyParamCaption})}



The routine does a matrix multiplication of a real matrix with a complex wave function along the x-\/direction. {\ttfamily ifadd} allows accumulating results but is not used in the present code. 

The operation carried out here includes a loop over the spin index.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em xmat} & R\+E\+A\+L(db), takes the matrix dimensioned as a square matrix with the number of points in the x-\/direction. \\
\hline
\mbox{\texttt{ in}}  & {\em pinn} & C\+O\+M\+P\+L\+E\+X(db), array, takes the input wave function. \\
\hline
\mbox{\texttt{ out}}  & {\em pout} & C\+O\+M\+P\+L\+E\+X(db), array, returns the multiplied wave function. \\
\hline
\mbox{\texttt{ in}}  & {\em ifadd} & I\+N\+T\+E\+G\+ER, if nonzero, the result of the multiplication is added to the input wave function. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacetrivial_ac100e58f8f8789ec83e5f8621f510601}\label{namespacetrivial_ac100e58f8f8789ec83e5f8621f510601}} 
\index{trivial@{trivial}!cmuly@{cmuly}}
\index{cmuly@{cmuly}!trivial@{trivial}}
\doxyparagraph{\texorpdfstring{cmuly()}{cmuly()}}
{\footnotesize\ttfamily pure subroutine trivial\+::cmuly (\begin{DoxyParamCaption}\item[{real(db), dimension(\+:,\+:), intent(in)}]{ymat,  }\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(in)}]{pinn,  }\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(inout)}]{pout,  }\item[{integer, intent(in)}]{ifadd }\end{DoxyParamCaption})}



The routine does a matrix multiplication of a real matrix with a complex wave function along the y-\/direction. {\ttfamily ifadd} allows accumulating results but is not used in the present code. 

The operation carried out here includes a loop over the spin index.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ymat} & R\+E\+A\+L(db), takes the matrix dimensioned as a square matrix with the number of points in the y-\/direction. \\
\hline
\mbox{\texttt{ in}}  & {\em pinn} & C\+O\+M\+P\+L\+E\+X(db), array, takes the input wave function. \\
\hline
\mbox{\texttt{ out}}  & {\em pout} & C\+O\+M\+P\+L\+E\+X(db), array, returns the multiplied wave function. \\
\hline
\mbox{\texttt{ in}}  & {\em ifadd} & I\+N\+T\+E\+G\+ER, if nonzero, the result of the multiplication is added to the input wave function. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacetrivial_a243661d8508f72313a919706a2c26625}\label{namespacetrivial_a243661d8508f72313a919706a2c26625}} 
\index{trivial@{trivial}!cmulz@{cmulz}}
\index{cmulz@{cmulz}!trivial@{trivial}}
\doxyparagraph{\texorpdfstring{cmulz()}{cmulz()}}
{\footnotesize\ttfamily pure subroutine trivial\+::cmulz (\begin{DoxyParamCaption}\item[{real(db), dimension(\+:,\+:), intent(in)}]{zmat,  }\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(in)}]{pinn,  }\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(inout)}]{pout,  }\item[{integer, intent(in)}]{ifadd }\end{DoxyParamCaption})}



The routine does a matrix multiplication of a real matrix with a complex wave function along the z-\/direction. {\ttfamily ifadd} allows accumulating results but is not used in the present code. 

The operation carried out here includes a loop over the spin index.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em zmat} & R\+E\+A\+L(db), takes the matrix dimensioned as a square matrix with the number of points in the z-\/direction. \\
\hline
\mbox{\texttt{ in}}  & {\em pinn} & C\+O\+M\+P\+L\+E\+X(db), array, takes the input wave function. \\
\hline
\mbox{\texttt{ out}}  & {\em pout} & C\+O\+M\+P\+L\+E\+X(db), array, returns the multiplied wave function. \\
\hline
\mbox{\texttt{ in}}  & {\em ifadd} & I\+N\+T\+E\+G\+ER, if nonzero, the result of the multiplication is added to the input wave function. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacetrivial_a3f458ad8429d9bc562bbbd15095bed75}\label{namespacetrivial_a3f458ad8429d9bc562bbbd15095bed75}} 
\index{trivial@{trivial}!overlap@{overlap}}
\index{overlap@{overlap}!trivial@{trivial}}
\doxyparagraph{\texorpdfstring{overlap()}{overlap()}}
{\footnotesize\ttfamily pure complex(db) function trivial\+::overlap (\begin{DoxyParamCaption}\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(in)}]{pl,  }\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(in)}]{pr }\end{DoxyParamCaption})}



This calculates the overlap of two wave functions $ psi_L $ and $ psi_R $. 

This is defined as \begin{eqnarray} \langle\psi_L|\psi_R\rangle&=&\sum_{s=\pm{1\over2}}\int \psi_L^*(\vec r)\,\psi_R(\vec r)\,\D^3 r \\ &\rightarrow& {\tt wxyz}\sum_{s=1}^2 \sum_{i=1}^{nx}\sum_{j=1}^{ny}\sum_{k=1}^{nz} {\tt CONJG(pl(i,j,k,s))pr(i,j,k,s)}. \end{eqnarray}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em pl} & C\+O\+M\+P\+E\+X(db), array, takes $ psi_L $. \\
\hline
\mbox{\texttt{ in}}  & {\em pr} & C\+O\+M\+P\+E\+X(db), array, takes $ psi_R $. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacetrivial_a709f609007f308ec3ef3228f0d9c9096}\label{namespacetrivial_a709f609007f308ec3ef3228f0d9c9096}} 
\index{trivial@{trivial}!rmulx@{rmulx}}
\index{rmulx@{rmulx}!trivial@{trivial}}
\doxyparagraph{\texorpdfstring{rmulx()}{rmulx()}}
{\footnotesize\ttfamily pure subroutine trivial\+::rmulx (\begin{DoxyParamCaption}\item[{real(db), dimension(\+:,\+:), intent(in)}]{xmat,  }\item[{real(db), dimension(\+:,\+:,\+:), intent(in)}]{finn,  }\item[{real(db), dimension(\+:,\+:,\+:), intent(inout)}]{fout,  }\item[{integer, intent(in)}]{ifadd }\end{DoxyParamCaption})}



The routine does a matrix multiplication of a real matrix with a real field along the x-\/direction. {\ttfamily ifadd} allows accumulating or substracting results. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em xmat} & R\+E\+A\+L(db), takes the matrix dimensioned as a square matrix with the number of points in the x-\/direction. \\
\hline
\mbox{\texttt{ in}}  & {\em finn} & R\+E\+A\+L(db), array, takes the input wave function. \\
\hline
\mbox{\texttt{ out}}  & {\em fout} & R\+E\+A\+L(db), array, returns the multiplied wave function. \\
\hline
\mbox{\texttt{ in}}  & {\em ifadd} & I\+N\+T\+E\+G\+ER, if positive, the result of the multiplication is added to the input wave function, if negative it is substracted. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacetrivial_ac00c799e850a49fb3288523658177649}\label{namespacetrivial_ac00c799e850a49fb3288523658177649}} 
\index{trivial@{trivial}!rmuly@{rmuly}}
\index{rmuly@{rmuly}!trivial@{trivial}}
\doxyparagraph{\texorpdfstring{rmuly()}{rmuly()}}
{\footnotesize\ttfamily pure subroutine trivial\+::rmuly (\begin{DoxyParamCaption}\item[{real(db), dimension(\+:,\+:), intent(in)}]{ymat,  }\item[{real(db), dimension(\+:,\+:,\+:), intent(in)}]{finn,  }\item[{real(db), dimension(\+:,\+:,\+:), intent(inout)}]{fout,  }\item[{integer, intent(in)}]{ifadd }\end{DoxyParamCaption})}



The routine does a matrix multiplication of a real matrix with a real field along the y-\/direction. {\ttfamily ifadd} allows accumulating or substracting results. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ymat} & R\+E\+A\+L(db), takes the matrix dimensioned as a square matrix with the number of points in the y-\/direction. \\
\hline
\mbox{\texttt{ in}}  & {\em finn} & R\+E\+A\+L(db), array, takes the input wave function. \\
\hline
\mbox{\texttt{ out}}  & {\em fout} & R\+E\+A\+L(db), array, returns the multiplied wave function. \\
\hline
\mbox{\texttt{ in}}  & {\em ifadd} & I\+N\+T\+E\+G\+ER, if positive, the result of the multiplication is added to the input wave function, if negative it is substracted. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacetrivial_afd24333775edb22cf43e7c1c17c4523f}\label{namespacetrivial_afd24333775edb22cf43e7c1c17c4523f}} 
\index{trivial@{trivial}!rmulz@{rmulz}}
\index{rmulz@{rmulz}!trivial@{trivial}}
\doxyparagraph{\texorpdfstring{rmulz()}{rmulz()}}
{\footnotesize\ttfamily pure subroutine trivial\+::rmulz (\begin{DoxyParamCaption}\item[{real(db), dimension(\+:,\+:), intent(in)}]{zmat,  }\item[{real(db), dimension(\+:,\+:,\+:), intent(in)}]{finn,  }\item[{real(db), dimension(\+:,\+:,\+:), intent(inout)}]{fout,  }\item[{integer, intent(in)}]{ifadd }\end{DoxyParamCaption})}



The routine does a matrix multiplication of a real matrix with a real field along the z-\/direction. {\ttfamily ifadd} allows accumulating or substracting results. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em zmat} & R\+E\+A\+L(db), takes the matrix dimensioned as a square matrix with the number of points in the z-\/direction. \\
\hline
\mbox{\texttt{ in}}  & {\em finn} & R\+E\+A\+L(db), array, takes the input wave function. \\
\hline
\mbox{\texttt{ out}}  & {\em fout} & R\+E\+A\+L(db), array, returns the multiplied wave function. \\
\hline
\mbox{\texttt{ in}}  & {\em ifadd} & I\+N\+T\+E\+G\+ER, if positive, the result of the multiplication is added to the input wave function, if negative it is substracted. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacetrivial_a34769580d54109e0070186feb150dfc0}\label{namespacetrivial_a34769580d54109e0070186feb150dfc0}} 
\index{trivial@{trivial}!rpsnorm@{rpsnorm}}
\index{rpsnorm@{rpsnorm}!trivial@{trivial}}
\doxyparagraph{\texorpdfstring{rpsnorm()}{rpsnorm()}}
{\footnotesize\ttfamily pure real(db) function trivial\+::rpsnorm (\begin{DoxyParamCaption}\item[{complex(db), dimension(\+:,\+:,\+:,\+:), intent(in)}]{ps }\end{DoxyParamCaption})}



This function with one argument calculates the norm of a wave function. 

i.\+e., \[ |\psi|=\sum_{s=\pm{1\over2}}\int |\psi(\vec r,s)|^2\,\D^3 r\rightarrow {\tt wxyz}\sum_{s=1}^2 \sum_{i=1}^{nx}\sum_{j=1}^{ny}\sum_{k=1}^{nz} |{\tt psi(i,j,k,s)}|^2, \] with {\ttfamily wxyz} the volume element.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ps} & C\+O\+M\+P\+L\+E\+X(db), array, takes the wave function. \\
\hline
\end{DoxyParams}
