<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sky3D: external Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sky3D
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespaceexternal.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">external Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module allows the coupling of the nucleonic wave functions to an external field.  
<a href="namespaceexternal.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7b6a22a5df2618253961de7bfac3edc3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a7b6a22a5df2618253961de7bfac3edc3">getin_external</a></td></tr>
<tr class="memdesc:a7b6a22a5df2618253961de7bfac3edc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">It reads in all the parameters of the external field.  <a href="namespaceexternal.html#a7b6a22a5df2618253961de7bfac3edc3">More...</a><br /></td></tr>
<tr class="separator:a7b6a22a5df2618253961de7bfac3edc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f9008155aa9c3456e709e0667dcb7ed"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a9f9008155aa9c3456e709e0667dcb7ed">init_external</a></td></tr>
<tr class="memdesc:a9f9008155aa9c3456e709e0667dcb7ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">It does some consistency checks of the external parameters and initializes the external field.  <a href="namespaceexternal.html#a9f9008155aa9c3456e709e0667dcb7ed">More...</a><br /></td></tr>
<tr class="separator:a9f9008155aa9c3456e709e0667dcb7ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6598d81653c164baa56a1c63176c7a22"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a6598d81653c164baa56a1c63176c7a22">extfld</a> (time)</td></tr>
<tr class="memdesc:a6598d81653c164baa56a1c63176c7a22"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is again a very straightforward routine. It calculates the time-dependent prefactor <code>time_factor</code> depending on the parameters, and adds the time-independent field <code>extfield</code> multiplied by this factor to <code>upot</code>. The physical time is here given as an argument, because it needs to be evaluated at both full and half time steps.  <a href="namespaceexternal.html#a6598d81653c164baa56a1c63176c7a22">More...</a><br /></td></tr>
<tr class="separator:a6598d81653c164baa56a1c63176c7a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1caf7a333063d49ee27956462ee531"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#acc1caf7a333063d49ee27956462ee531">extboost</a> (noboostflag)</td></tr>
<tr class="memdesc:acc1caf7a333063d49ee27956462ee531"><td class="mdescLeft">&#160;</td><td class="mdescRight">This performs the initial boost on all single-particle wave functions.  <a href="namespaceexternal.html#acc1caf7a333063d49ee27956462ee531">More...</a><br /></td></tr>
<tr class="separator:acc1caf7a333063d49ee27956462ee531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af39bcf0867c7a8aebddd6865341fbdbb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#af39bcf0867c7a8aebddd6865341fbdbb">print_extfield</a> ()</td></tr>
<tr class="memdesc:af39bcf0867c7a8aebddd6865341fbdbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates the expectation of the coupling energy to the external field,.  <a href="namespaceexternal.html#af39bcf0867c7a8aebddd6865341fbdbb">More...</a><br /></td></tr>
<tr class="separator:af39bcf0867c7a8aebddd6865341fbdbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a78cd193c1f66b79b1a8496431e8a6db0"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a78cd193c1f66b79b1a8496431e8a6db0">isoext</a> =0</td></tr>
<tr class="memdesc:a78cd193c1f66b79b1a8496431e8a6db0"><td class="mdescLeft">&#160;</td><td class="mdescRight">isospin behavior of the external field: <code>isoext</code> denotes the same action on protons and neutrons, <code> isoext=1 </code> that with opposing signs.  <a href="namespaceexternal.html#a78cd193c1f66b79b1a8496431e8a6db0">More...</a><br /></td></tr>
<tr class="separator:a78cd193c1f66b79b1a8496431e8a6db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0410fea857fe9ab1bf4e5dd867a503ea"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a0410fea857fe9ab1bf4e5dd867a503ea">ipulse</a> =0</td></tr>
<tr class="memdesc:a0410fea857fe9ab1bf4e5dd867a503ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">type of pulse. <code> ipulse=0</code> denotes the initial boost configuration, <code> ipulse=1 </code> a Gaussian pulse and <code> ipulse=2 </code> a cosine squared behavior.  <a href="namespaceexternal.html#a0410fea857fe9ab1bf4e5dd867a503ea">More...</a><br /></td></tr>
<tr class="separator:a0410fea857fe9ab1bf4e5dd867a503ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad762cc8c4ba4c1feff9bab357a55c47e"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#ad762cc8c4ba4c1feff9bab357a55c47e">extfield</a></td></tr>
<tr class="memdesc:ad762cc8c4ba4c1feff9bab357a55c47e"><td class="mdescLeft">&#160;</td><td class="mdescRight">this is the time-independent field generated according to the parameters <code>amplq0</code>, <code>textfield_periodic</code> and depending on the latter, possibly <code>radext</code> and <code>widext</code>. It is used either to calculate the initial boost or is added to the mean field multiplied with the time-dependent factor.  <a href="namespaceexternal.html#ad762cc8c4ba4c1feff9bab357a55c47e">More...</a><br /></td></tr>
<tr class="separator:ad762cc8c4ba4c1feff9bab357a55c47e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b38afd4ab0a5d9eb2832d7ab2339d18"><td class="memItemLeft" align="right" valign="top">real(db), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a9b38afd4ab0a5d9eb2832d7ab2339d18">amplq0</a> =0.D0</td></tr>
<tr class="memdesc:a9b38afd4ab0a5d9eb2832d7ab2339d18"><td class="mdescLeft">&#160;</td><td class="mdescRight">a strength parameter for the perturbation. Its numerical magnitude is usually not important by itself, but varying it allows studying the effects of different strengths of the excitation.  <a href="namespaceexternal.html#a9b38afd4ab0a5d9eb2832d7ab2339d18">More...</a><br /></td></tr>
<tr class="separator:a9b38afd4ab0a5d9eb2832d7ab2339d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a307bd6147b6d044f25b5db58079f17f3"><td class="memItemLeft" align="right" valign="top">real(db), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a307bd6147b6d044f25b5db58079f17f3">radext</a> =100.D0</td></tr>
<tr class="memdesc:a307bd6147b6d044f25b5db58079f17f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">parameter <img class="formulaInl" alt="$r_0$" src="form_109.png"/> for the cutoff of the field in fm.  <a href="namespaceexternal.html#a307bd6147b6d044f25b5db58079f17f3">More...</a><br /></td></tr>
<tr class="separator:a307bd6147b6d044f25b5db58079f17f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c78da7cadd7f1cfb81f7b612b6a7e2"><td class="memItemLeft" align="right" valign="top">real(db), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#af3c78da7cadd7f1cfb81f7b612b6a7e2">widext</a> =1.D0</td></tr>
<tr class="memdesc:af3c78da7cadd7f1cfb81f7b612b6a7e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">parameter <img class="formulaInl" alt="$\Delta_0$" src="form_110.png"/> for the cutoff of the field in fm.  <a href="namespaceexternal.html#af3c78da7cadd7f1cfb81f7b612b6a7e2">More...</a><br /></td></tr>
<tr class="separator:af3c78da7cadd7f1cfb81f7b612b6a7e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade752705f2ad6796fdd2c327535a75c6"><td class="memItemLeft" align="right" valign="top">real(db), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#ade752705f2ad6796fdd2c327535a75c6">omega</a> =0.D0</td></tr>
<tr class="memdesc:ade752705f2ad6796fdd2c327535a75c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">parameter <img class="formulaInl" alt="$ \omega $" src="form_111.png"/> for time-dependent excitation  <a href="namespaceexternal.html#ade752705f2ad6796fdd2c327535a75c6">More...</a><br /></td></tr>
<tr class="separator:ade752705f2ad6796fdd2c327535a75c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c039ebdad0a07c53dc48268135f0d75"><td class="memItemLeft" align="right" valign="top">real(db), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a0c039ebdad0a07c53dc48268135f0d75">taut</a></td></tr>
<tr class="memdesc:a0c039ebdad0a07c53dc48268135f0d75"><td class="mdescLeft">&#160;</td><td class="mdescRight">parameter <img class="formulaInl" alt="$ \Delta\tau $" src="form_112.png"/> for time-dependent excitation  <a href="namespaceexternal.html#a0c039ebdad0a07c53dc48268135f0d75">More...</a><br /></td></tr>
<tr class="separator:a0c039ebdad0a07c53dc48268135f0d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee73b55e270275118af5f5b0a7b8a94"><td class="memItemLeft" align="right" valign="top">real(db), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#abee73b55e270275118af5f5b0a7b8a94">tau0</a></td></tr>
<tr class="memdesc:abee73b55e270275118af5f5b0a7b8a94"><td class="mdescLeft">&#160;</td><td class="mdescRight">parameter <img class="formulaInl" alt="$ \tau_0 $" src="form_113.png"/> for time-dependent excitation  <a href="namespaceexternal.html#abee73b55e270275118af5f5b0a7b8a94">More...</a><br /></td></tr>
<tr class="separator:abee73b55e270275118af5f5b0a7b8a94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f5363ccffa9ace7f49d9354106a5a1"><td class="memItemLeft" align="right" valign="top">logical, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a14f5363ccffa9ace7f49d9354106a5a1">textfield_periodic</a> =.false.</td></tr>
<tr class="memdesc:a14f5363ccffa9ace7f49d9354106a5a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">if this is set to <code>true</code>, the external field is made periodic by substituting <img class="formulaInl" alt="$ x^2\rightarrow\sin^2\left(\pi x/x_L\right) $" src="form_114.png"/>, otherwise a damping factor is used <img class="formulaInl" alt="$ F_q(\vec r) \rightarrow \frac{F_q(\vec r)}{1+e^{(r-r_0)/\Delta r}} $" src="form_115.png"/>.  <a href="namespaceexternal.html#a14f5363ccffa9ace7f49d9354106a5a1">More...</a><br /></td></tr>
<tr class="separator:a14f5363ccffa9ace7f49d9354106a5a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58321273277630e218505f8f0fc3ea2f"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#a58321273277630e218505f8f0fc3ea2f">l_val</a> =0</td></tr>
<tr class="memdesc:a58321273277630e218505f8f0fc3ea2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">paramter <img class="formulaInl" alt="$L_{val}$" src="form_116.png"/>, the orbital angular quantum number(L) used in the definition of spherical harmoninc ( <img class="formulaInl" alt="$Y_{L}^{M}$" src="form_117.png"/>) which is used while defining the external field  <a href="namespaceexternal.html#a58321273277630e218505f8f0fc3ea2f">More...</a><br /></td></tr>
<tr class="separator:a58321273277630e218505f8f0fc3ea2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4255a781f779432088d52a94c3d5479"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceexternal.html#ac4255a781f779432088d52a94c3d5479">m_val</a> =0</td></tr>
<tr class="memdesc:ac4255a781f779432088d52a94c3d5479"><td class="mdescLeft">&#160;</td><td class="mdescRight">paramter <img class="formulaInl" alt="$M_{val}$" src="form_118.png"/>, the projection quantum number(M) used in the definition of spherical harmoninc ( <img class="formulaInl" alt="$Y_{L}^{M}$" src="form_117.png"/>) which is used while defining the external field  <a href="namespaceexternal.html#ac4255a781f779432088d52a94c3d5479">More...</a><br /></td></tr>
<tr class="separator:ac4255a781f779432088d52a94c3d5479"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module allows the coupling of the nucleonic wave functions to an external field. </p>
<p>This can be done either by adding a time-dependent external (i.e., not self-consistent) potential to the single-particle Hamiltonian. The time-dependence can be of Gaussian form </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(t)=\exp\left(-(t-\tau_0)^2/\Delta\tau^2\right)\cos(\omega(\tau-\tau_0)) \]" src="form_101.png"/>
</p>
<p> or cosine squared form </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(t)=\cos\left(\frac\pi{2}\left(\frac{t-\tau_0}{\Delta\tau}\right)^2\right) \theta\left(\Delta\tau-|t-\tau_0|\right)\cos(\omega(\tau-\tau_0)) \]" src="form_102.png"/>
</p>
<p> or by giving an initial "boost" </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \psi_k(\vec r,s,t\!=\!0)= \psi_{k,0}(\vec r,s)\,\exp\left(-\I \eta F_q(\vec r)\right) \]" src="form_103.png"/>
</p>
<p> to each wave function. Since this is very easy to modify and will probably have to be adjusted for most applications, the present version just contains a sample for a quadrupole coupling. The logic for different time-dependence assumptions and the isospin are however, fully functional and should be useful in many cases.</p>
<p>The operator <img class="formulaInl" alt="$ F_q $" src="form_104.png"/> is the excitation operator which can be of any form from monopole to dipole, quadrupole, octupole and so on. However to avoid the spurious states in the strength the definition in the case of dipole (L=1) is different than all the other as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ F_{1M} = (r^3 - \frac{5}{3}&lt;r^2&gt; r)Y_{1M} \]" src="form_105.png"/>
</p>
<p> where <img class="formulaInl" alt="$ &lt;r^2&gt; $" src="form_106.png"/> is the average value of <img class="formulaInl" alt="$r^2$" src="form_34.png"/> given as input (r2_avg) for this case. For all orger cases <img class="formulaInl" alt="$ F_q $" src="form_104.png"/> is defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ F_{LM} = \sqrt{2L+1} r^L Y_{LM} \]" src="form_107.png"/>
</p>
<p> where <img class="formulaInl" alt="$ Y_{LM} $" src="form_108.png"/> are the spherical harmonics. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="acc1caf7a333063d49ee27956462ee531"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc1caf7a333063d49ee27956462ee531">&#9670;&nbsp;</a></span>extboost()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine external::extboost </td>
          <td>(</td>
          <td class="paramtype">logical, intent(out)&#160;</td>
          <td class="paramname"><em>noboostflag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This performs the initial boost on all single-particle wave functions. </p>
<p>Note that it is always called from <code>dynamichf</code> and checks itself whether <code>ipulse</code> is zero. This enables <code>ipulse</code> to also be made a private variable. Its argument is used to communicate whether it has actually done anything: if it has applied a boost, it sets its argument to <code></code>.FALSE. so that in <code>dynamichf</code> the variable <code>text_timedep</code> makes it possible to distinguish this case.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">noboostflag</td><td>LOGICAL, returns if boost has to be performed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6598d81653c164baa56a1c63176c7a22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6598d81653c164baa56a1c63176c7a22">&#9670;&nbsp;</a></span>extfld()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine external::extfld </td>
          <td>(</td>
          <td class="paramtype">real(db), intent(in)&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is again a very straightforward routine. It calculates the time-dependent prefactor <code>time_factor</code> depending on the parameters, and adds the time-independent field <code>extfield</code> multiplied by this factor to <code>upot</code>. The physical time is here given as an argument, because it needs to be evaluated at both full and half time steps. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>REAL(db), takes the current time. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7b6a22a5df2618253961de7bfac3edc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b6a22a5df2618253961de7bfac3edc3">&#9670;&nbsp;</a></span>getin_external()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine external::getin_external</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It reads in all the parameters of the external field. </p>

</div>
</div>
<a id="a9f9008155aa9c3456e709e0667dcb7ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f9008155aa9c3456e709e0667dcb7ed">&#9670;&nbsp;</a></span>init_external()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine external::init_external</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It does some consistency checks of the external parameters and initializes the external field. </p>
<p>The relative strength for the neutron and proton fields is set equal for <code> isoext=0 </code> but reduced by the corresponding number of particles in the <code> isoext=1 </code>. This avoids a shift of the center of mass in this case.</p>
<p>Then the array <code>extfield</code> is allocated and the time-independent spatial potential calculated for both isospin cases and in either the periodic or damped versions, depending on the value of <code>textfield_periodic.This</code> is just an illustrative sample field of type <img class="formulaInl" alt="$ Q_{zz} $" src="form_119.png"/>; in a real calculation there is no need to provide both versions. TODO: This routine is not documented correctly in the "old" pdf manual!!! </p>

</div>
</div>
<a id="af39bcf0867c7a8aebddd6865341fbdbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af39bcf0867c7a8aebddd6865341fbdbb">&#9670;&nbsp;</a></span>print_extfield()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine external::print_extfield</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine calculates the expectation of the coupling energy to the external field,. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_q\int\,\D^3r\,\rho_q(\vec r)F_q(\vec r) \]" src="form_120.png"/>
</p>
<p> and prints one line containing the present time and this value onto the file <code>extfieldfile</code>. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9b38afd4ab0a5d9eb2832d7ab2339d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b38afd4ab0a5d9eb2832d7ab2339d18">&#9670;&nbsp;</a></span>amplq0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), private external::amplq0 =0.D0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>a strength parameter for the perturbation. Its numerical magnitude is usually not important by itself, but varying it allows studying the effects of different strengths of the excitation. </p>

</div>
</div>
<a id="ad762cc8c4ba4c1feff9bab357a55c47e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad762cc8c4ba4c1feff9bab357a55c47e">&#9670;&nbsp;</a></span>extfield</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:), allocatable, private external::extfield</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this is the time-independent field generated according to the parameters <code>amplq0</code>, <code>textfield_periodic</code> and depending on the latter, possibly <code>radext</code> and <code>widext</code>. It is used either to calculate the initial boost or is added to the mean field multiplied with the time-dependent factor. </p>

</div>
</div>
<a id="a0410fea857fe9ab1bf4e5dd867a503ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0410fea857fe9ab1bf4e5dd867a503ea">&#9670;&nbsp;</a></span>ipulse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private external::ipulse =0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>type of pulse. <code> ipulse=0</code> denotes the initial boost configuration, <code> ipulse=1 </code> a Gaussian pulse and <code> ipulse=2 </code> a cosine squared behavior. </p>

</div>
</div>
<a id="a78cd193c1f66b79b1a8496431e8a6db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78cd193c1f66b79b1a8496431e8a6db0">&#9670;&nbsp;</a></span>isoext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private external::isoext =0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>isospin behavior of the external field: <code>isoext</code> denotes the same action on protons and neutrons, <code> isoext=1 </code> that with opposing signs. </p>

</div>
</div>
<a id="a58321273277630e218505f8f0fc3ea2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58321273277630e218505f8f0fc3ea2f">&#9670;&nbsp;</a></span>l_val</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private external::l_val =0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>paramter <img class="formulaInl" alt="$L_{val}$" src="form_116.png"/>, the orbital angular quantum number(L) used in the definition of spherical harmoninc ( <img class="formulaInl" alt="$Y_{L}^{M}$" src="form_117.png"/>) which is used while defining the external field </p>

</div>
</div>
<a id="ac4255a781f779432088d52a94c3d5479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4255a781f779432088d52a94c3d5479">&#9670;&nbsp;</a></span>m_val</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, private external::m_val =0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>paramter <img class="formulaInl" alt="$M_{val}$" src="form_118.png"/>, the projection quantum number(M) used in the definition of spherical harmoninc ( <img class="formulaInl" alt="$Y_{L}^{M}$" src="form_117.png"/>) which is used while defining the external field </p>

</div>
</div>
<a id="ade752705f2ad6796fdd2c327535a75c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade752705f2ad6796fdd2c327535a75c6">&#9670;&nbsp;</a></span>omega</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), private external::omega =0.D0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>parameter <img class="formulaInl" alt="$ \omega $" src="form_111.png"/> for time-dependent excitation </p>

</div>
</div>
<a id="a307bd6147b6d044f25b5db58079f17f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a307bd6147b6d044f25b5db58079f17f3">&#9670;&nbsp;</a></span>radext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), private external::radext =100.D0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>parameter <img class="formulaInl" alt="$r_0$" src="form_109.png"/> for the cutoff of the field in fm. </p>

</div>
</div>
<a id="abee73b55e270275118af5f5b0a7b8a94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee73b55e270275118af5f5b0a7b8a94">&#9670;&nbsp;</a></span>tau0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), private external::tau0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>parameter <img class="formulaInl" alt="$ \tau_0 $" src="form_113.png"/> for time-dependent excitation </p>

</div>
</div>
<a id="a0c039ebdad0a07c53dc48268135f0d75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c039ebdad0a07c53dc48268135f0d75">&#9670;&nbsp;</a></span>taut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), private external::taut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>parameter <img class="formulaInl" alt="$ \Delta\tau $" src="form_112.png"/> for time-dependent excitation </p>

</div>
</div>
<a id="a14f5363ccffa9ace7f49d9354106a5a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f5363ccffa9ace7f49d9354106a5a1">&#9670;&nbsp;</a></span>textfield_periodic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, private external::textfield_periodic =.false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>if this is set to <code>true</code>, the external field is made periodic by substituting <img class="formulaInl" alt="$ x^2\rightarrow\sin^2\left(\pi x/x_L\right) $" src="form_114.png"/>, otherwise a damping factor is used <img class="formulaInl" alt="$ F_q(\vec r) \rightarrow \frac{F_q(\vec r)}{1+e^{(r-r_0)/\Delta r}} $" src="form_115.png"/>. </p>

</div>
</div>
<a id="af3c78da7cadd7f1cfb81f7b612b6a7e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3c78da7cadd7f1cfb81f7b612b6a7e2">&#9670;&nbsp;</a></span>widext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), private external::widext =1.D0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>parameter <img class="formulaInl" alt="$\Delta_0$" src="form_110.png"/> for the cutoff of the field in fm. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceexternal.html">external</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
