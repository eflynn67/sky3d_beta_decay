<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sky3D: twobody Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sky3D
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacetwobody.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">twobody Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains the routines to distinguish between a one and two-body system and to perform a two-body analysis in the case of a two-body collision including scattering angles and momenta.  
<a href="namespacetwobody.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a2330263249174a77f31f7d221b32ecd2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a2330263249174a77f31f7d221b32ecd2">twobody_analysis</a> (full_analysis)</td></tr>
<tr class="memdesc:a2330263249174a77f31f7d221b32ecd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">For a two-body collision, this subroutine checks whether the system is separated and in that case determines either only the distance of the fragments or, for the final state, produces a detailed analysis.  <a href="namespacetwobody.html#a2330263249174a77f31f7d221b32ecd2">More...</a><br /></td></tr>
<tr class="separator:a2330263249174a77f31f7d221b32ecd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae44d409d045e1a7e46e63d1166633885"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#ae44d409d045e1a7e46e63d1166633885">analyze</a> (ifrag)</td></tr>
<tr class="memdesc:ae44d409d045e1a7e46e63d1166633885"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates properties of the two separate fragment or of the whole system.  <a href="namespacetwobody.html#ae44d409d045e1a7e46e63d1166633885">More...</a><br /></td></tr>
<tr class="separator:ae44d409d045e1a7e46e63d1166633885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383bfa98740a91ee8ba2b8d1e2bd308a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a383bfa98740a91ee8ba2b8d1e2bd308a">gauss</a> (a, b, c)</td></tr>
<tr class="memdesc:a383bfa98740a91ee8ba2b8d1e2bd308a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine does a simple direct solution of the 3 by 3 linear system of equations.  <a href="namespacetwobody.html#a383bfa98740a91ee8ba2b8d1e2bd308a">More...</a><br /></td></tr>
<tr class="separator:a383bfa98740a91ee8ba2b8d1e2bd308a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebc4b35f90a4ba0188028f8799f7f462"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#aebc4b35f90a4ba0188028f8799f7f462">scattering</a></td></tr>
<tr class="memdesc:aebc4b35f90a4ba0188028f8799f7f462"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates the relative motion and the various energies in the final state and, by referring back to the initial state before the collision, also the net scattering results.  <a href="namespacetwobody.html#aebc4b35f90a4ba0188028f8799f7f462">More...</a><br /></td></tr>
<tr class="separator:aebc4b35f90a4ba0188028f8799f7f462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d40744e5bb0676f61280e518b5555ac"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a9d40744e5bb0676f61280e518b5555ac">cut_system</a> (full_analysis)</td></tr>
<tr class="memdesc:a9d40744e5bb0676f61280e518b5555ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine finds out whether the system can be decomposed into two fragments records the geometry of this decomposition.  <a href="namespacetwobody.html#a9d40744e5bb0676f61280e518b5555ac">More...</a><br /></td></tr>
<tr class="separator:a9d40744e5bb0676f61280e518b5555ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7421597c06f0fee95ef869ee4125ec3c"><td class="memItemLeft" align="right" valign="top">real(db) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a7421597c06f0fee95ef869ee4125ec3c">getslope</a> ()</td></tr>
<tr class="memdesc:a7421597c06f0fee95ef869ee4125ec3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this function the slope of the fragment connection line in the <img class="formulaInl" alt="$x-z $" src="form_259.png"/> plane is determined.  <a href="namespacetwobody.html#a7421597c06f0fee95ef869ee4125ec3c">More...</a><br /></td></tr>
<tr class="separator:a7421597c06f0fee95ef869ee4125ec3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a5db841ae42fb0913afd1f592159f1"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a72a5db841ae42fb0913afd1f592159f1">divpoint</a> (xmin, zmin, bb, slope)</td></tr>
<tr class="memdesc:a72a5db841ae42fb0913afd1f592159f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function divpoint examines the line determined by the axis of largest quadrupole moment to look for a suitable separation point between two fragments. If one is found with sufficiently low density, it returns <code>TRUE</code> and the properties of that point in its arguments. Otherwise it returns <code>FALSE</code>.  <a href="namespacetwobody.html#a72a5db841ae42fb0913afd1f592159f1">More...</a><br /></td></tr>
<tr class="separator:a72a5db841ae42fb0913afd1f592159f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:abb1f19bd8de3cd06a90cb0be37f89bea"><td class="memItemLeft" align="right" valign="top">real(db), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#abb1f19bd8de3cd06a90cb0be37f89bea">threshold</a> =1.D-5</td></tr>
<tr class="memdesc:abb1f19bd8de3cd06a90cb0be37f89bea"><td class="mdescLeft">&#160;</td><td class="mdescRight">threshold density to recognze separate fragmenst  <a href="namespacetwobody.html#abb1f19bd8de3cd06a90cb0be37f89bea">More...</a><br /></td></tr>
<tr class="separator:abb1f19bd8de3cd06a90cb0be37f89bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3faecacbdb442de749fe70c30728f444"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a3faecacbdb442de749fe70c30728f444">mass_case</a></td></tr>
<tr class="memdesc:a3faecacbdb442de749fe70c30728f444"><td class="mdescLeft">&#160;</td><td class="mdescRight">records the initial mass relation. 0 indicates a symmetric collision, 1 that fragment #1 is the lighter one, 2 that fragment #2 is heavier. This is needed to order the fragments the same way in the final state.  <a href="namespacetwobody.html#a3faecacbdb442de749fe70c30728f444">More...</a><br /></td></tr>
<tr class="separator:a3faecacbdb442de749fe70c30728f444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed651dcad4935f4cff54b95a1d791092"><td class="memItemLeft" align="right" valign="top">real(db)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#aed651dcad4935f4cff54b95a1d791092">roft</a></td></tr>
<tr class="memdesc:aed651dcad4935f4cff54b95a1d791092"><td class="mdescLeft">&#160;</td><td class="mdescRight">fragment separation at the current time, zero means connected system  <a href="namespacetwobody.html#aed651dcad4935f4cff54b95a1d791092">More...</a><br /></td></tr>
<tr class="separator:aed651dcad4935f4cff54b95a1d791092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b4a03d159774bc105a30873aa2bfdc3"><td class="memItemLeft" align="right" valign="top">real(db)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a9b4a03d159774bc105a30873aa2bfdc3">roft_old</a></td></tr>
<tr class="memdesc:a9b4a03d159774bc105a30873aa2bfdc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">fragment separation at the last time step. Needed to check whether the motion is outgoing or incoming  <a href="namespacetwobody.html#a9b4a03d159774bc105a30873aa2bfdc3">More...</a><br /></td></tr>
<tr class="separator:a9b4a03d159774bc105a30873aa2bfdc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d1f788f4eeaffe4819a7688117ebd21"><td class="memItemLeft" align="right" valign="top">real(db), dimension(3, 0:2)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a9d1f788f4eeaffe4819a7688117ebd21">velocity</a></td></tr>
<tr class="memdesc:a9d1f788f4eeaffe4819a7688117ebd21"><td class="mdescLeft">&#160;</td><td class="mdescRight">c.m. velocity vectors for the total system and the fragments  <a href="namespacetwobody.html#a9d1f788f4eeaffe4819a7688117ebd21">More...</a><br /></td></tr>
<tr class="separator:a9d1f788f4eeaffe4819a7688117ebd21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a903caebecd1d2127d0ac9e7d379a57b0"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a903caebecd1d2127d0ac9e7d379a57b0">rhotot</a></td></tr>
<tr class="memdesc:a903caebecd1d2127d0ac9e7d379a57b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">total density  <a href="namespacetwobody.html#a903caebecd1d2127d0ac9e7d379a57b0">More...</a><br /></td></tr>
<tr class="separator:a903caebecd1d2127d0ac9e7d379a57b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101c61c5e7316c281654170add663303"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a101c61c5e7316c281654170add663303">currtot</a></td></tr>
<tr class="memdesc:a101c61c5e7316c281654170add663303"><td class="mdescLeft">&#160;</td><td class="mdescRight">total current density  <a href="namespacetwobody.html#a101c61c5e7316c281654170add663303">More...</a><br /></td></tr>
<tr class="separator:a101c61c5e7316c281654170add663303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3817f0f66f20d1fe6310db16b91adc"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a5e3817f0f66f20d1fe6310db16b91adc">frag</a></td></tr>
<tr class="memdesc:a5e3817f0f66f20d1fe6310db16b91adc"><td class="mdescLeft">&#160;</td><td class="mdescRight">for each mesh pint, tells whether it is in fragment 1 or 2, or below the cutoff density, (value 0)  <a href="namespacetwobody.html#a5e3817f0f66f20d1fe6310db16b91adc">More...</a><br /></td></tr>
<tr class="separator:a5e3817f0f66f20d1fe6310db16b91adc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf94ee03e78b349d4269ab8186c236a7"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#acf94ee03e78b349d4269ab8186c236a7">istwobody</a></td></tr>
<tr class="memdesc:acf94ee03e78b349d4269ab8186c236a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">principal return value. Tells whether the system is separated.  <a href="namespacetwobody.html#acf94ee03e78b349d4269ab8186c236a7">More...</a><br /></td></tr>
<tr class="separator:acf94ee03e78b349d4269ab8186c236a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">mass,charge, c.m., momentum, and angular momentum of the total system and the fragments</div></td></tr>
<tr class="memitem:a8bd07e07192b10c28601fcf4fb33f5d8"><td class="memItemLeft" align="right" valign="top">real(db), dimension(0:2)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a8bd07e07192b10c28601fcf4fb33f5d8">mass</a></td></tr>
<tr class="separator:a8bd07e07192b10c28601fcf4fb33f5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a106274f3ec31d1cf1acd95be8e48a958"><td class="memItemLeft" align="right" valign="top">real(db), dimension(0:2)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a106274f3ec31d1cf1acd95be8e48a958">charge</a></td></tr>
<tr class="separator:a106274f3ec31d1cf1acd95be8e48a958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9cccd46f8d1c9decdf96594d353472e"><td class="memItemLeft" align="right" valign="top">real(db), dimension(3, 0:2)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#ab9cccd46f8d1c9decdf96594d353472e">cmfrag</a></td></tr>
<tr class="separator:ab9cccd46f8d1c9decdf96594d353472e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2100c772082008166c536aced5a79c5b"><td class="memItemLeft" align="right" valign="top">real(db), dimension(3, 0:2)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a2100c772082008166c536aced5a79c5b">momentum</a></td></tr>
<tr class="separator:a2100c772082008166c536aced5a79c5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2457901b1c62691433d20e06d5896005"><td class="memItemLeft" align="right" valign="top">real(db), dimension(3, 0:2)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetwobody.html#a2457901b1c62691433d20e06d5896005">angmom</a></td></tr>
<tr class="separator:a2457901b1c62691433d20e06d5896005"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains the routines to distinguish between a one and two-body system and to perform a two-body analysis in the case of a two-body collision including scattering angles and momenta. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae44d409d045e1a7e46e63d1166633885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae44d409d045e1a7e46e63d1166633885">&#9670;&nbsp;</a></span>analyze()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine twobody::analyze </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ifrag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine calculates properties of the two separate fragment or of the whole system. </p>
<p>It evaluates integrated quantities for a subset of the mesh controlled by its argument <code>ifrag</code> in conjunction with the array <code>frag</code>. More specifically, <code>ifrag=0</code> is used to calculate on the whole mesh while <code>ifrag=1</code> or 2 select the points belonging to the corresponding fragment. The array <code>frag</code> contains the relevant index for each mesh point.</p><ul>
<li>Most of the calculated quantities have an index <code>ifrag</code> to store these results separately. Thus <code>cm(1:3,0:2)</code> is used to store the total center of mass in <code>cm(:,0)</code> and the centers of mass of the two fragments in <code>cm(:,1)</code> or <code>cm(:,2)</code>, respectively.</li>
<li>The first loop and the following statements calculate the mass number, charge number, center of mass, and total momentum of the system or fragment. From the latter two velocities are derived: <code>velcorr</code>, which is in the units used for the <code>current</code> density in Sky3D, namely fm <img class="formulaInl" alt="$^{-4}$" src="form_230.png"/>, while <code>velocity</code> is in units of <img class="formulaInl" alt="$c$" src="form_231.png"/>.</li>
<li>The next loop calculates the collective orbital angular momentum <code>angmom</code> with respect to the center of mass, subtracting its motion, and the classical tensor <img class="formulaInl" alt="$\Theta$" src="form_232.png"/> of inertia, <code>inertia</code>. This allows calculating also the instantaneous angular velocity vector <code>omega</code> by solving <img class="formulaInl" alt="$\vec L=\Theta\vec\omega$" src="form_233.png"/> using the subroutine <code>gauss</code>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ifrag</td><td>INTEGER, index of fragment 1 or 2 to be investigated, or 0 for whole system </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9d40744e5bb0676f61280e518b5555ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d40744e5bb0676f61280e518b5555ac">&#9670;&nbsp;</a></span>cut_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine twobody::cut_system </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>full_analysis</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine finds out whether the system can be decomposed into two fragments records the geometry of this decomposition. </p>
<p>There is an iteration using index <code>itcm</code> to make the line connecting the centers of the fragments consistent. It starts with the quadrupole tensor principal axis using function <code>getslope</code>. After calculating the fragment centers-of-mass, this is corrected iteratively. Within the loop the following steps are executed:</p><ol type="1">
<li>If this is not the first iteration, calculate the slope of the center-connecting line from the centers of mass.</li>
<li>Call <code>divpoint</code> to find whether there is a sufficiently low density between two fragments along that line. If there is, keep track of the minimum-density location.</li>
<li>Taking the line from that point, calculate the properties of the line perpendicular to the inter-center connection: the line dividing space between the fragments.</li>
<li>Then assign fragment index <code>frag(ix,iy,iz)</code> for each grid point by checking which side of the dividing line they are on. At the same time, accumulate data for the fragment masses and centers of mass.</li>
<li>If the centers of mass have not changed significantly, stop the iterations. Otherwise repeat.</li>
<li>Record the center distance and return if this is not a full analysis.</li>
<li>Finally, make sure that the assignment of fragment index to heavier or lighter fragment remains the same. This uses array <code>swap</code> to interchange 1 and 2.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">full_analysis</td><td>LOGICAL, if false, do only what is necessary for calculating the distance </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a72a5db841ae42fb0913afd1f592159f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72a5db841ae42fb0913afd1f592159f1">&#9670;&nbsp;</a></span>divpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function twobody::divpoint </td>
          <td>(</td>
          <td class="paramtype">real(db), intent(out)&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(db), intent(out)&#160;</td>
          <td class="paramname"><em>zmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(db), intent(in)&#160;</td>
          <td class="paramname"><em>bb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(db), intent(in)&#160;</td>
          <td class="paramname"><em>slope</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function divpoint examines the line determined by the axis of largest quadrupole moment to look for a suitable separation point between two fragments. If one is found with sufficiently low density, it returns <code>TRUE</code> and the properties of that point in its arguments. Otherwise it returns <code>FALSE</code>. </p>
<p>To this end it looks at the behavior of the densities along this line. Since the line has no relation to the numerical grid, this is not trivial.</p><ul>
<li><b> First loop: </b> Essentially it looks through the <img class="formulaInl" alt="$(x,z)$" src="form_260.png"/>-plane to find points closer than half a grid spacing to the desired line with equation <code>z=slope*x+bb</code> (logical variable <code>online</code>). If the slope is larger than one, i. e., if the nuclei are separating predominantly in the <img class="formulaInl" alt="$x$" src="form_240.png"/>-direction, we need to take the equation <code>x=(z-bb)/slope</code> instead to get better resolution. To make the result monotonic along the line, the do loop in <img class="formulaInl" alt="$z$" src="form_241.png"/> runs backward for negative slopes. The points found are collected in index vectors <code>ixl</code>, <code>izl</code> with accompanying densities <code>rhol </code> stored in arrays of length <code>il</code>.</li>
<li><b> Second loop: </b> now the number of fragments <code>nf</code> is counted by examining this one-dimensional density curve, looking for disconnected density humps above <code>vacuum</code> density. Where the `&lsquo;vacuum&rsquo;' region starts and ends is recorded in variables <code>n1</code> and <code>n2</code>. The logic is as follows:<ol type="1">
<li>The logical variable <code>in_vacuum</code> keeps track of whether the search is in a vacuum region at the moment or not. It starts as <code>TRUE</code>.</li>
<li>Go to the next point. If its density is above <code>vacuum</code>, and we are in the vacuum, a new fragment is starting and we increase the number of fragments <code>nf</code> by 1. If it becomes bigger than 2, exit, because there are three or more fragments. If it is now 2, record the starting index for the second fragment in <code>n2</code>.</li>
<li>If the density is below <code>vacuum</code> and we are not in vacuum, a fragment is being ended. If it is the first fragment, we record this index in <code>n1</code>.</li>
</ol>
</li>
<li><b> Final processing: </b> At this point we expect a two-fragment situation if <code>nf=2</code> and in this case the void region between the fragments extends from <code>n1</code> to <code>n2</code>, which are indices into arrays <code>ix1</code> and <code>iz1</code> giving the position in the <img class="formulaInl" alt="$(x,z)$" src="form_260.png"/>-plane. The code calculates the midpoint between the two positions and returns <code>TRUE</code> in this case.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>LOGICAL, indicates whether there is a fragment division or not. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">xmin</td><td>REAL(db), <img class="formulaInl" alt="$x$" src="form_240.png"/>-coordinate of the dividing point. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">zmin</td><td>REAL(db), <img class="formulaInl" alt="$z$" src="form_241.png"/>-coordinate of the dividing point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bb</td><td>REAL(db), intercept of the line joining the fragments.. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slope</td><td>REAL(db), slope of the line joining the fragments. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a383bfa98740a91ee8ba2b8d1e2bd308a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a383bfa98740a91ee8ba2b8d1e2bd308a">&#9670;&nbsp;</a></span>gauss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine twobody::gauss </td>
          <td>(</td>
          <td class="paramtype">real(db), dimension(3,3), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(db), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(db), dimension(3), intent(out)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine does a simple direct solution of the 3 by 3 linear system of equations. </p>
<p>This is an explicit implementation using the determinant algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a(3,3)</td><td>REAL(db), Matrix of the linear system. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b(3)</td><td>REAL(db), right-hand side of the equations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c(3)</td><td>REAL(db), solution vector. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7421597c06f0fee95ef869ee4125ec3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7421597c06f0fee95ef869ee4125ec3c">&#9670;&nbsp;</a></span>getslope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db) function twobody::getslope</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In this function the slope of the fragment connection line in the <img class="formulaInl" alt="$x-z $" src="form_259.png"/> plane is determined. </p>
<p>The slope is determined by the eigenvector of largest quadrupole moment in the <img class="formulaInl" alt="$(x,z)$" src="form_260.png"/>-plane. The first loop sums up the quadrupole tensor, which is dimensioned <code> q2(3,3)</code> but of which the index 2 is not actually necessary, since the <img class="formulaInl" alt="$y$" src="form_258.png"/>-direction is not involved. The definition is kept three-dimensional to reduce confusion and make later generalization easier. The two-dimensional eigenvalue problem for <code>q2</code> has the secular equation: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[(q_{11}-\lambda)(q_{33}-\lambda)-q_{13}^2=0,\]" src="form_261.png"/>
</p>
<p> with <img class="formulaInl" alt="$\lambda$" src="form_262.png"/> the eigenvalue. For the larger eigenvalue we get </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[\lambda=\frac1{2}\left(q_{11}+q_{33}+\sqrt{(q_{11}-q_{33})^2 -4q_{13}^2}\right),\]" src="form_263.png"/>
</p>
<p> and solving the equation <img class="formulaInl" alt="$q_{13}x+(q_{33}-\lambda)z=0$" src="form_264.png"/> for <img class="formulaInl" alt="$z$" src="form_241.png"/> yields </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} z&amp;=&amp;\frac{q_{13}}{\lambda-q_{33}}\,x\\ &amp;=&amp; \frac{q_{13}}{\frac1{2}\left(q_{11}-q_{33}+\sqrt{(q_{11}-q_{33})^2 -4q_{13}^2}\right)}. \end{eqnarray*}" src="form_265.png"/>
</p>
<p> The code calls the denominator <code>denom</code> and makes sure no division by zero happens (this could happen for a spherical distribution). The resulting slope is returned in the module variable <code>slope</code>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">newslope</td><td>REAL(db), calculated slope. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aebc4b35f90a4ba0188028f8799f7f462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebc4b35f90a4ba0188028f8799f7f462">&#9670;&nbsp;</a></span>scattering()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine twobody::scattering</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine calculates the relative motion and the various energies in the final state and, by referring back to the initial state before the collision, also the net scattering results. </p>
<p>The subroutine calculates the scattering angle as the sum of three contributions: the ingoing Rutherford angle, the rotation angle during the TDHF calculation, and the outgoing Rutherford angle.</p>
<p>The Rutherford trajectories are hyperbolas described in polar coordinates as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[r(\phi)=\frac{k}{\epsilon\cos\phi-1}.\]" src="form_234.png"/>
</p>
<p> with <img class="formulaInl" alt="$r$" src="form_235.png"/> and <img class="formulaInl" alt="$\phi$" src="form_236.png"/> describing the relative vector of the two-body problem. It is confined to the angular region <img class="formulaInl" alt="$-\phi_\infty&lt;\phi&lt;\phi_\infty$" src="form_237.png"/> with the asymptotic angle <img class="formulaInl" alt="$\phi_\infty=\cos^{-1}(\epsilon^{-1})$" src="form_238.png"/>. The angle <img class="formulaInl" alt="$\phi=0$" src="form_239.png"/> corresponds to the symmetry axis of the hyperbola.</p>
<p>A problem is that this axis is not directly connected to the coordinates used for the TDHF calculation, which is assumed to have <img class="formulaInl" alt="$x$" src="form_240.png"/> and <img class="formulaInl" alt="$z$" src="form_241.png"/> as the reaction plane. Since, however, the parameters of the hyperbola <img class="formulaInl" alt="$k$" src="form_242.png"/> and <img class="formulaInl" alt="$\epsilon$" src="form_243.png"/> can be calculated from the impact parameter and energy of the relative motion, it suffices to know <img class="formulaInl" alt="$r$" src="form_235.png"/> to calculate the angle corresponding to it in the hyperbola system of coordinates. This is done slightly differently for the incoming and outgoing trajectories.</p>
<p>The following steps are done:</p><ul>
<li>Examine the initial state before the collision: Since the properties of the fragments may not be available anymore after a restart, we have to partially restore them from the original input files. <em>This requires that these files, or symbolic links to them, be present in current directory.</em> From <code>for005</code> it reads the center-of-mass energy <img class="formulaInl" alt="$E_{\rm cm}$" src="form_244.png"/> and impact parameter <img class="formulaInl" alt="$b$" src="form_245.png"/> as well as the initial positions of the nuclei for the start of the TDHF calculation, <img class="formulaInl" alt="$\vec r_{0i},\;i=1,2$" src="form_246.png"/> called <code>fcent(:,i)</code> in the code. Then the masses <img class="formulaInl" alt="$A_i$" src="form_247.png"/> and charges <img class="formulaInl" alt="$Z_i$" src="form_248.png"/> are input from the fragment data files.</li>
<li>As the next step, the variable <code>mass_case</code> is determined to make sure the mass relation is the same in the ingoing and outgoing case. For symmetric collisions of course the scattering is not uniquely determined. From these data the following quantities are successively calculated:<ol type="1">
<li>The initial relative vector for the TDHF calculation <p class="formulaDsp">
<img class="formulaDsp" alt="\[\vec r(t=0)=\vec r_2(t=0)-\vec r_1(t=0),\]" src="form_249.png"/>
</p>
</li>
<li>the initial reduced mass <p class="formulaDsp">
<img class="formulaDsp" alt="\[\mu=m_0\frac{A_1A_2}{A_1+A_2},\]" src="form_250.png"/>
</p>
</li>
<li>the dimensionless initial orbital angular momentum of relative motion, <p class="formulaDsp">
<img class="formulaDsp" alt="\[L_{\rm init}=\mu v_{\rm init}b=\mu\sqrt{\frac{2E_{\rm cm}}{\mu}}\, \frac{b}{\hbar}.\]" src="form_251.png"/>
</p>
 From these quantities the parameters of the hyperbola can be calculated:</li>
<li>the parameter <img class="formulaInl" alt="$ k $" src="form_17.png"/> <p class="formulaDsp">
<img class="formulaDsp" alt="\[ k=\frac{L_{\rm init}^2\hbar^2}{e^2Z_1Z_2\mu},\]" src="form_252.png"/>
</p>
</li>
<li>the major axis <p class="formulaDsp">
<img class="formulaDsp" alt="\[a=\frac{e^2Z_1Z_2}{2E_{\rm cm}},\]" src="form_253.png"/>
</p>
</li>
<li>from which <img class="formulaInl" alt="$ \epsilon $" src="form_219.png"/> results: <p class="formulaDsp">
<img class="formulaDsp" alt="\[\epsilon=\frac{\sqrt{a^2+b^2}}{a}.\]" src="form_254.png"/>
</p>
 Now the angles can be calculated from the equation of the hyperbola. The asymptotic angle <p class="formulaDsp">
<img class="formulaDsp" alt="\[\phi_\infty=\cos^{-1}(1/\epsilon)\]" src="form_255.png"/>
</p>
 and the angle corresponding to the initial position, <p class="formulaDsp">
<img class="formulaDsp" alt="\[\phi(t=0)=\cos^{-1}\left(\frac{k/|\vec r(t=0)|+1}{\epsilon}\right).\]" src="form_256.png"/>
</p>
 In the code both are converted to degrees. The incoming Rutherford scattering angle is just the difference, <p class="formulaDsp">
<img class="formulaDsp" alt="\[\phi_{\rm incoming}=\phi_\infty-\phi(t=0).\]" src="form_257.png"/>
</p>
</li>
</ol>
</li>
<li>The rotation of the system during the TDHF calculation is obtained from the initial and final positions of the fragments via the scalar product of the relative vectors.</li>
<li>The code then calculates the relative motion properties in the final state: reduced mass <code>mu</code>, relative velocity <code>vrel</code>, kinetic energy <code>erel</code>, and angular momentum of relative motion <code>relangmom</code>. In addition the point-charge Coulomb interaction energy <code>ecoul_point</code>, the velocity and kinetic energy in the radial direction <code>rdot</code> and <code>edot</code> are produced for information.</li>
<li>For the extrapolation of the relative motion energy to infinite separation a more refinde calculation of the Coulomb energy is needed. This is done by using subroutine <code>poisson</code> three times: once for the total system and then for each fragment individually by removing the charge density from all space points associated with the other fragment. This yields <code>ecoul(0:2)</code> and the Coulomb interaction energy <code>ecoul_int</code> can then be obtained as <code>ecoul(0)-ecoul(1)-ecoul(2)</code>. The asymptotic energy is then the sum of <code>erel</code> and <code>ecoul_int</code>.</li>
<li>Finally the deflection angle for the outgoing Rutherford trajectory is obtained. The main difference to the incoming trajectory is that now the quantities determining the hyperbola parameters are taken from the two-body analysis, namely the masses and charges of the fragments, the <img class="formulaInl" alt="$y$" src="form_258.png"/>-component of the angular momentum of relative motion <code>relangmom(1:2)</code>, and the final energy of relative motion <code>final_ecm</code>. Otherwise the calculation proceeds identically, though the variable <code>b</code> has to be renamed <code>b</code>, since the impact parameter may be different for the final state.</li>
<li>The subroutine then prints all the details. </li>
</ul>

</div>
</div>
<a id="a2330263249174a77f31f7d221b32ecd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2330263249174a77f31f7d221b32ecd2">&#9670;&nbsp;</a></span>twobody_analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine twobody::twobody_analysis </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>full_analysis</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For a two-body collision, this subroutine checks whether the system is separated and in that case determines either only the distance of the fragments or, for the final state, produces a detailed analysis. </p>
<p>The subroutine starts off by allocating arrays <code>rhotot</code> and, if the full analysis is desired, <code>currtot</code>, which are then assigned the total density and current density, respectively. These are set to zero wherever the density is below the <code>threshold</code>. Then the following steps are taken:</p><ul>
<li>For the full analysis the total current density and the isospin-dependent density and current density are also cut off. Then the subroutine <code>analyze</code> is called for the whole system by setting <code>frag</code> such that all points have fragment index 0. The coordinate values are corrected for a shift in the center-of-mass. The total current density is then adjusted to remove any overall motion of the system in the grid.</li>
<li>Following this, subroutine <code>cut_system</code> is called to calculation fragment properties in the case of separation. If <code>full_analysis</code> is true, this should be the case, as it is done only for the final state.</li>
<li>For <code>full_analysis=false</code>, the analysis is finished, since the fragment distance has been calculated. Therefore there is a <code>RETURN</code> after the arrays have been deallocated.</li>
<li>After this the subroutine <code>analyze</code> is called separately for the two fragments to determine their properties</li>
<li>Based on this information, subroutine <code>scattering</code> is called to calculate relative motion and the overall scattering results.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">full_analysis</td><td>LOGICAL, if TRUE the full analysis is done, otherwise only the fragment separation is calculated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2457901b1c62691433d20e06d5896005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2457901b1c62691433d20e06d5896005">&#9670;&nbsp;</a></span>angmom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(3,0:2) twobody::angmom</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a106274f3ec31d1cf1acd95be8e48a958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a106274f3ec31d1cf1acd95be8e48a958">&#9670;&nbsp;</a></span>charge</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(0:2) twobody::charge</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab9cccd46f8d1c9decdf96594d353472e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9cccd46f8d1c9decdf96594d353472e">&#9670;&nbsp;</a></span>cmfrag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(3,0:2) twobody::cmfrag</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a101c61c5e7316c281654170add663303"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a101c61c5e7316c281654170add663303">&#9670;&nbsp;</a></span>currtot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:), allocatable, private twobody::currtot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>total current density </p>

</div>
</div>
<a id="a5e3817f0f66f20d1fe6310db16b91adc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3817f0f66f20d1fe6310db16b91adc">&#9670;&nbsp;</a></span>frag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:,:), allocatable, private twobody::frag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>for each mesh pint, tells whether it is in fragment 1 or 2, or below the cutoff density, (value 0) </p>

</div>
</div>
<a id="acf94ee03e78b349d4269ab8186c236a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf94ee03e78b349d4269ab8186c236a7">&#9670;&nbsp;</a></span>istwobody</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical twobody::istwobody</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>principal return value. Tells whether the system is separated. </p>

</div>
</div>
<a id="a8bd07e07192b10c28601fcf4fb33f5d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bd07e07192b10c28601fcf4fb33f5d8">&#9670;&nbsp;</a></span>mass</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(0:2) twobody::mass</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3faecacbdb442de749fe70c30728f444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3faecacbdb442de749fe70c30728f444">&#9670;&nbsp;</a></span>mass_case</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer twobody::mass_case</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>records the initial mass relation. 0 indicates a symmetric collision, 1 that fragment #1 is the lighter one, 2 that fragment #2 is heavier. This is needed to order the fragments the same way in the final state. </p>

</div>
</div>
<a id="a2100c772082008166c536aced5a79c5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2100c772082008166c536aced5a79c5b">&#9670;&nbsp;</a></span>momentum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(3,0:2) twobody::momentum</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a903caebecd1d2127d0ac9e7d379a57b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a903caebecd1d2127d0ac9e7d379a57b0">&#9670;&nbsp;</a></span>rhotot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:), allocatable, private twobody::rhotot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>total density </p>

</div>
</div>
<a id="aed651dcad4935f4cff54b95a1d791092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed651dcad4935f4cff54b95a1d791092">&#9670;&nbsp;</a></span>roft</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db) twobody::roft</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fragment separation at the current time, zero means connected system </p>

</div>
</div>
<a id="a9b4a03d159774bc105a30873aa2bfdc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b4a03d159774bc105a30873aa2bfdc3">&#9670;&nbsp;</a></span>roft_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db) twobody::roft_old</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fragment separation at the last time step. Needed to check whether the motion is outgoing or incoming </p>

</div>
</div>
<a id="abb1f19bd8de3cd06a90cb0be37f89bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb1f19bd8de3cd06a90cb0be37f89bea">&#9670;&nbsp;</a></span>threshold</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), parameter twobody::threshold =1.D-5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>threshold density to recognze separate fragmenst </p>

</div>
</div>
<a id="a9d1f788f4eeaffe4819a7688117ebd21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d1f788f4eeaffe4819a7688117ebd21">&#9670;&nbsp;</a></span>velocity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(3,0:2) twobody::velocity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>c.m. velocity vectors for the total system and the fragments </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacetwobody.html">twobody</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
