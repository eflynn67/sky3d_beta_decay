<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sky3D: meanfield Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sky3D
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemeanfield.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">meanfield Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module calculates all the ingredients needed for the energy functional and for applying the single-particle Hamiltonian to a wave function.  
<a href="namespacemeanfield.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4cb67584e46b31740ffabfcb7f5ca87a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#a4cb67584e46b31740ffabfcb7f5ca87a">alloc_fields</a></td></tr>
<tr class="memdesc:a4cb67584e46b31740ffabfcb7f5ca87a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine has the simple task of allocating all the fields that are local to the module <code>Meanfield</code>.  <a href="namespacemeanfield.html#a4cb67584e46b31740ffabfcb7f5ca87a">More...</a><br /></td></tr>
<tr class="separator:a4cb67584e46b31740ffabfcb7f5ca87a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c1c8da2cee7b2d1d8c2ddc451881af"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#a98c1c8da2cee7b2d1d8c2ddc451881af">skyrme</a></td></tr>
<tr class="memdesc:a98c1c8da2cee7b2d1d8c2ddc451881af"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this subroutine the various fields are calculated from the densities that were previously generated in module <code>Densities</code>.  <a href="namespacemeanfield.html#a98c1c8da2cee7b2d1d8c2ddc451881af">More...</a><br /></td></tr>
<tr class="separator:a98c1c8da2cee7b2d1d8c2ddc451881af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad360aa7a912c2b6ffcb71715bd026eb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#aad360aa7a912c2b6ffcb71715bd026eb">hpsi</a> (iq, eshift, pinn, pout)</td></tr>
<tr class="memdesc:aad360aa7a912c2b6ffcb71715bd026eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine applies the single-particle Hamiltonian to a single-particle wave function <code>pinn</code> to produce an output wave function <code>pout</code>. The argument <code>iq</code> indicates the isospin for the wave function and <code>eshift</code> is an energy shift which is zero in the dynamic calculation but crucial to the static algorithm (see <code>grstep</code> in module <code>Static</code>).  <a href="namespacemeanfield.html#aad360aa7a912c2b6ffcb71715bd026eb">More...</a><br /></td></tr>
<tr class="separator:aad360aa7a912c2b6ffcb71715bd026eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae33ff83f4833d75bb02e0ab18f145ecc"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#ae33ff83f4833d75bb02e0ab18f145ecc">upot</a></td></tr>
<tr class="memdesc:ae33ff83f4833d75bb02e0ab18f145ecc"><td class="mdescLeft">&#160;</td><td class="mdescRight">this is the local part of the mean field <img class="formulaInl" alt="$ U_q $" src="form_152.png"/>. It is a scalar field with isospin index.  <a href="namespacemeanfield.html#ae33ff83f4833d75bb02e0ab18f145ecc">More...</a><br /></td></tr>
<tr class="separator:ae33ff83f4833d75bb02e0ab18f145ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a550cb619aaf736be4ffd3dd264f1d4d6"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#a550cb619aaf736be4ffd3dd264f1d4d6">bmass</a></td></tr>
<tr class="memdesc:a550cb619aaf736be4ffd3dd264f1d4d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">this is the effective mass <img class="formulaInl" alt="$ B_q $" src="form_153.png"/>. It is a scalar, isospin-dependent field.  <a href="namespacemeanfield.html#a550cb619aaf736be4ffd3dd264f1d4d6">More...</a><br /></td></tr>
<tr class="separator:a550cb619aaf736be4ffd3dd264f1d4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51b6b329b3e2a5a2922df8851529665"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#ab51b6b329b3e2a5a2922df8851529665">divaq</a></td></tr>
<tr class="memdesc:ab51b6b329b3e2a5a2922df8851529665"><td class="mdescLeft">&#160;</td><td class="mdescRight">this is the divergence of <code>aq</code>, i.e., <img class="formulaInl" alt="$ \nabla\cdot\vec A_q $" src="form_154.png"/>. Its is a scalar, isospin-dependent field.  <a href="namespacemeanfield.html#ab51b6b329b3e2a5a2922df8851529665">More...</a><br /></td></tr>
<tr class="separator:ab51b6b329b3e2a5a2922df8851529665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfa27213f417177960e263a95322dd3"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#a7dfa27213f417177960e263a95322dd3">aq</a></td></tr>
<tr class="memdesc:a7dfa27213f417177960e263a95322dd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the vector filed <img class="formulaInl" alt="$ \vec A_q $" src="form_155.png"/>. It is a vector, isospin-dependent field. <br  />
  <a href="namespacemeanfield.html#a7dfa27213f417177960e263a95322dd3">More...</a><br /></td></tr>
<tr class="separator:a7dfa27213f417177960e263a95322dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896d6b3cedb68e94d1ba1b884234252a"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#a896d6b3cedb68e94d1ba1b884234252a">spot</a></td></tr>
<tr class="memdesc:a896d6b3cedb68e94d1ba1b884234252a"><td class="mdescLeft">&#160;</td><td class="mdescRight">the field <img class="formulaInl" alt="$ \vec{S}_q $" src="form_156.png"/>. It is a vector, isospin-dependent field.  <a href="namespacemeanfield.html#a896d6b3cedb68e94d1ba1b884234252a">More...</a><br /></td></tr>
<tr class="separator:a896d6b3cedb68e94d1ba1b884234252a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf751ae2685ad4f639428c1e8d872bd0"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#acf751ae2685ad4f639428c1e8d872bd0">wlspot</a></td></tr>
<tr class="memdesc:acf751ae2685ad4f639428c1e8d872bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">the field <img class="formulaInl" alt="$ \vec W_q $" src="form_157.png"/>. It is a vector, isospin-dependent field.  <a href="namespacemeanfield.html#acf751ae2685ad4f639428c1e8d872bd0">More...</a><br /></td></tr>
<tr class="separator:acf751ae2685ad4f639428c1e8d872bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63dea2736dc69161491a371cf15e587f"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:,:,:), allocatable, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemeanfield.html#a63dea2736dc69161491a371cf15e587f">dbmass</a></td></tr>
<tr class="memdesc:a63dea2736dc69161491a371cf15e587f"><td class="mdescLeft">&#160;</td><td class="mdescRight">contains the gradient of <code>bmass</code>. It is a vector, isospin-dependent field.  <a href="namespacemeanfield.html#a63dea2736dc69161491a371cf15e587f">More...</a><br /></td></tr>
<tr class="separator:a63dea2736dc69161491a371cf15e587f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module calculates all the ingredients needed for the energy functional and for applying the single-particle Hamiltonian to a wave function. </p>
<p>The work is done by two subroutines: <code>skyrme</code> for the calculation of all the fields, which can be scalar or vector and isospin-dependent. <code>hpsi</code> then is the routine applying the single-particle Hamiltonian to one single-particle wave function.</p>
<p>Note the division of labor between <code>skyrme</code> and <code>add_density</code> of module <code>Densities:</code> everything that constructs fields - densities and current densities - from the single-particle wave functions is done in <code>add_density</code>, which is called in a loop over the states, while <code>skyrme</code> does the further manipulations to complete the fields entering the single-particle Hamiltonian by combining the densities and their derivatives. It does not need access to the wave functions. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a4cb67584e46b31740ffabfcb7f5ca87a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cb67584e46b31740ffabfcb7f5ca87a">&#9670;&nbsp;</a></span>alloc_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine meanfield::alloc_fields</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine has the simple task of allocating all the fields that are local to the module <code>Meanfield</code>. </p>

</div>
</div>
<a id="aad360aa7a912c2b6ffcb71715bd026eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad360aa7a912c2b6ffcb71715bd026eb">&#9670;&nbsp;</a></span>hpsi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine meanfield::hpsi </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(db), intent(in)&#160;</td>
          <td class="paramname"><em>eshift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(db), dimension(:,:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>pinn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(db), dimension(:,:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine applies the single-particle Hamiltonian to a single-particle wave function <code>pinn</code> to produce an output wave function <code>pout</code>. The argument <code>iq</code> indicates the isospin for the wave function and <code>eshift</code> is an energy shift which is zero in the dynamic calculation but crucial to the static algorithm (see <code>grstep</code> in module <code>Static</code>). </p>
<p>For an understanding of this module the role of the following local variables is crucial. They are</p><ul>
<li><code>is:</code> this is used in the loops over spin to indicate the spin component: <code> is=1 </code> for spin up and <code> is=2 </code> for spin down.</li>
<li><code>ic:</code> denotes the index for the opposite spin; it is calculated as <code> ic=3-is </code>. Note the similar handling of the two isospin projections using <code>iq</code> and <code>icomp</code> in subroutine <code>skyrme</code>.</li>
<li><code>sigis:</code> this variable denotes the sign of the spin projection. It is calculated as <code> sigis=3-2*is </code> and thus is <code>+1</code> for spin up (<code> is=1 </code>) and <code>-</code> for spin down (<code> is=2 </code>).</li>
</ul>
<p>The general structure of the subroutine is as follows: first the part of the Hamiltonian not involving derivatives is applied, followed by the terms involving derivatives in order <img class="formulaInl" alt="$ x $" src="form_127.png"/>, <img class="formulaInl" alt="$ y $" src="form_124.png"/>, $z$. Since the structure of the Hamiltonian involves only first or second derivatives in one spatial direction in each term, the derivatives can be calculated for one direction and then the working space can be reused for the next one.</p>
<p>The expressions for the different spatial derivatives are quite analogous, so that only the $x$-direction will be discussed at length below.</p>
<p>The expressions is repeated here: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \hat h=U_q(\vec r)-\nabla\cdot\left[B_q(\vec r)\nabla\right] +\I\vec W_q\cdot(\vec\sigma\times\nabla) +\vec S_q\cdot\vec\sigma -\frac{\I}{2} \left[(\nabla\cdot\vec A_q)+2\vec A_q\cdot\nabla\right]. \]" src="form_166.png"/>
</p>
<ol type="1">
<li>the non-derivative parts not involving spin. These arise from <img class="formulaInl" alt="$ U_q $" src="form_152.png"/> and <img class="formulaInl" alt="$ -\tfrac{\I}{2}\,\nabla\cdot\vec A_q $" src="form_167.png"/>, which are combined into a complex expression. The energy shift <code>eshift</code> is also included.</li>
<li>the spin current coupling is constructed by simply using the explicit definition of the Pauli matrices and multiplying the resulting matrix onto the spinor wave function.</li>
<li>the first and second derivative in the <img class="formulaInl" alt="$ x $" src="form_127.png"/>-direction are evaluated and stored in the arrays <code>pswk</code> and <code>pswk2</code>. The last term in the Hamiltonian gives rise to the two contributions <p class="formulaDsp">
<img class="formulaDsp" alt="\[ -\frac{\partial B_q}{\partial x}\frac{\partial}{\partial x}-B_q \frac{\partial^2}{\partial x^2}, \]" src="form_168.png"/>
</p>
 of which the second is evaluated straightforwardly, while the first one is combined with the spin-orbit contribution. The part of <img class="formulaInl" alt="$ \I\vec W_q\cdot(\vec\sigma\times\nabla) $" src="form_169.png"/> that contains an <img class="formulaInl" alt="$ x $" src="form_127.png"/>-derivative is <p class="formulaDsp">
<img class="formulaDsp" alt="\[ (\I W_y\sigma_z-\I W_z\sigma_y)\frac{\partial}{\partial x}= \begin{pmatrix} \I W_y&amp;-W_z\\ W_z&amp;-\I W_y \end{pmatrix}\frac{\partial}{\partial x} \]" src="form_170.png"/>
</p>
 This is programmed employing the variable <code>sigis</code> to account for the different signs in the rows of the matrix.</li>
<li>for the derivatives in the $y$-direction the procedure is similar; the spin-orbit part is now <p class="formulaDsp">
<img class="formulaDsp" alt="\[ (\I W_z\sigma_x-\I W_x\sigma_z)\frac{\partial}{\partial y}= \begin{pmatrix} -\I W_x&amp;\I W_z\\ \I W_z&amp;\I W_x \end{pmatrix}\frac{\partial}{\partial y} \]" src="form_171.png"/>
</p>
</li>
<li>for the derivatives in the <img class="formulaInl" alt="$ z $" src="form_125.png"/>-direction the procedure is again similar; the spin-orbit part is now <p class="formulaDsp">
<img class="formulaDsp" alt="\[ (\I W_x\sigma_y-\I W_y\sigma_x)\frac{\partial}{\partial z}= \begin{pmatrix} 0&amp;W_x-\I W_y\\ -W_x-\I W_y &amp; 0 \end{pmatrix}\frac{\partial}{\partial z} \]" src="form_172.png"/>
</p>
</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iq</td><td>INTEGER, takes the isospin. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eshift</td><td>REAL(db), takes the energy shift. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pinn</td><td>COMPLEX(db), array, takes the wave function the Hamiltonian is supposed to be applied to. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pout</td><td>COMPLEX(db), array, returns the Hamiltonian applied to the wave function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a98c1c8da2cee7b2d1d8c2ddc451881af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c1c8da2cee7b2d1d8c2ddc451881af">&#9670;&nbsp;</a></span>skyrme()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine meanfield::skyrme</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In this subroutine the various fields are calculated from the densities that were previously generated in module <code>Densities</code>. </p>
<p>The expressions divide up the contributions into an isospin-summed part with <img class="formulaInl" alt="$ b $" src="form_122.png"/>-coefficients followed by the isospin-dependent one with <img class="formulaInl" alt="$ b' $" src="form_123.png"/>-coefficients. As it would be a waste of space to store the summed densities and currents, the expressions are divided up more conveniently. If we denote the isospin index <img class="formulaInl" alt="$ q $" src="form_158.png"/> by <code>iq</code> and the index for the opposite isospin <img class="formulaInl" alt="$ q' $" src="form_159.png"/> by <code>ic</code> (as <code>iq</code> can take the values 1 or 2, it can conveniently be calculated as <code> 3-iq </code>), this can be written for example as</p>
<p><img class="formulaInl" alt="$ b_1\rho-b_1'\rho_q\longrightarrow b_1(\rho_q+\rho_{q'})-b_1'\rho_q $" src="form_160.png"/> <img class="formulaInl" alt="$ \longrightarrow $" src="form_161.png"/> <code>(b1-b1p)*rho(:,:,:,iq)+b1*rho(:,:,:,ic)</code> This decomposition is used in all applicable cases.</p>
<p>For intermediate results the fields <code>workden</code> (scalar) and <code>workvec</code> (vector) are used.</p>
<p>Now the subroutine proceeds in the following steps:</p><ol type="1">
<li>all the parts in <code>upot</code> involving an <img class="formulaInl" alt="$ \alpha $" src="form_162.png"/>-dependent power of the density are collected. Note that in order to avoid having to calculate different powers, <img class="formulaInl" alt="$ \rho^\alpha $" src="form_163.png"/> is factored out. The division by the total density uses the small number <code>epsilon</code> to avoid division by zero.</li>
<li>the divergence of <img class="formulaInl" alt="$ \vec J $" src="form_164.png"/> (<code>sodens</code>) is calculated for both isospins in <code>workden</code> and the contributions are added to <code>upot</code>.</li>
<li>the Coulomb potential is calculated using subroutine <code>poisson</code> (see module <code>Coulomb</code>). It and the Slater exchange correction (only if the <code>ex</code> parameter in the force is nonzero) are added to <code>upot</code> for protons, <code> iq=2 </code>.</li>
<li>the Laplacian is applied to the densities and the result stored in <code>workden</code>. Then the remaining terms are constructed. <br  />
 Note that the <code>iq</code> -loop is combined with the following steps.</li>
<li>the effective mass is calculated.</li>
<li>the gradient of the density is calculated and the spin-orbit vector <img class="formulaInl" alt="$ \vec W_q $" src="form_157.png"/> is constructed in <code>wlspot</code>.</li>
<li>the curl of the spin density vector is calculated and stored in <code>workvec</code>.</li>
<li>the vector <img class="formulaInl" alt="$ \vec A_q $" src="form_155.png"/> is calculated from the current density and the curl of the spin density.</li>
<li>the curl of the current density is calculated and stored in <code>spot</code>.</li>
<li>now the two isospin contributions in <code>spot</code> are combined in the proper way. This way of handling it avoids the introduction of an additional work vector for <img class="formulaInl" alt="$ \nabla\times\vec\jmath_q $" src="form_165.png"/>.</li>
<li>the divergence of <img class="formulaInl" alt="$ \vec A_q $" src="form_155.png"/> is calculated and stored in <code>divaq</code>.</li>
<li>finally, the gradient of the effective mass term <img class="formulaInl" alt="$ B_q $" src="form_153.png"/> is calculated and stored in the vector variable <code>dbmass</code>.</li>
</ol>
<p>This concludes the calculation of all scalar and vector fields needed for the application of the Skyrme force. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7dfa27213f417177960e263a95322dd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfa27213f417177960e263a95322dd3">&#9670;&nbsp;</a></span>aq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:,:), allocatable, private meanfield::aq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is the vector filed <img class="formulaInl" alt="$ \vec A_q $" src="form_155.png"/>. It is a vector, isospin-dependent field. <br  />
 </p>

</div>
</div>
<a id="a550cb619aaf736be4ffd3dd264f1d4d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a550cb619aaf736be4ffd3dd264f1d4d6">&#9670;&nbsp;</a></span>bmass</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:), allocatable meanfield::bmass</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this is the effective mass <img class="formulaInl" alt="$ B_q $" src="form_153.png"/>. It is a scalar, isospin-dependent field. </p>

</div>
</div>
<a id="a63dea2736dc69161491a371cf15e587f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63dea2736dc69161491a371cf15e587f">&#9670;&nbsp;</a></span>dbmass</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:,:), allocatable, private meanfield::dbmass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>contains the gradient of <code>bmass</code>. It is a vector, isospin-dependent field. </p>

</div>
</div>
<a id="ab51b6b329b3e2a5a2922df8851529665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51b6b329b3e2a5a2922df8851529665">&#9670;&nbsp;</a></span>divaq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:), allocatable, private meanfield::divaq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this is the divergence of <code>aq</code>, i.e., <img class="formulaInl" alt="$ \nabla\cdot\vec A_q $" src="form_154.png"/>. Its is a scalar, isospin-dependent field. </p>

</div>
</div>
<a id="a896d6b3cedb68e94d1ba1b884234252a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a896d6b3cedb68e94d1ba1b884234252a">&#9670;&nbsp;</a></span>spot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:,:), allocatable meanfield::spot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the field <img class="formulaInl" alt="$ \vec{S}_q $" src="form_156.png"/>. It is a vector, isospin-dependent field. </p>

</div>
</div>
<a id="ae33ff83f4833d75bb02e0ab18f145ecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33ff83f4833d75bb02e0ab18f145ecc">&#9670;&nbsp;</a></span>upot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:), allocatable meanfield::upot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this is the local part of the mean field <img class="formulaInl" alt="$ U_q $" src="form_152.png"/>. It is a scalar field with isospin index. </p>

</div>
</div>
<a id="acf751ae2685ad4f639428c1e8d872bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf751ae2685ad4f639428c1e8d872bd0">&#9670;&nbsp;</a></span>wlspot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(:,:,:,:,:), allocatable, private meanfield::wlspot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the field <img class="formulaInl" alt="$ \vec W_q $" src="form_157.png"/>. It is a vector, isospin-dependent field. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemeanfield.html">meanfield</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
