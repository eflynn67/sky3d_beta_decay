<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sky3D: fragments Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sky3D
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacefragments.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">fragments Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module is concerned with setting up the initial condition from data files containing fragment wave functions, usually obtained in a previous static calculation.  
<a href="namespacefragments.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:acd40a2830b84a9a5defb0691a84747b2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#acd40a2830b84a9a5defb0691a84747b2">getin_fragments</a></td></tr>
<tr class="memdesc:acd40a2830b84a9a5defb0691a84747b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine reads the input variables, makes some consistency checks, and then prepares for the initialization.  <a href="namespacefragments.html#acd40a2830b84a9a5defb0691a84747b2">More...</a><br /></td></tr>
<tr class="separator:acd40a2830b84a9a5defb0691a84747b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60355fb212340bf2d5988af3d9354967"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a60355fb212340bf2d5988af3d9354967">read_fragments</a></td></tr>
<tr class="memdesc:a60355fb212340bf2d5988af3d9354967"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine prints summary information about which fragment wave functions occupy which range of indices. Then it does a loop over fragments to read in their wave functions using <code>read_one_fragment</code>, followed by applying the boost to them using <code>boost_fragment</code>.  <a href="namespacefragments.html#a60355fb212340bf2d5988af3d9354967">More...</a><br /></td></tr>
<tr class="separator:a60355fb212340bf2d5988af3d9354967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace60d8e2552ba0068385e7195f2876c4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#ace60d8e2552ba0068385e7195f2876c4">read_one_fragment</a> (iff)</td></tr>
<tr class="memdesc:ace60d8e2552ba0068385e7195f2876c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine reopens a fragment file for the fragment indexed by <code>iff</code> and reads the wave functions, inserting them at the correct index into the new wave function array while also moving them to the desired center-of-mass position.  <a href="namespacefragments.html#ace60d8e2552ba0068385e7195f2876c4">More...</a><br /></td></tr>
<tr class="separator:ace60d8e2552ba0068385e7195f2876c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d43cd441c82e1ab9f347fe0076a44be"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a0d43cd441c82e1ab9f347fe0076a44be">locate</a> (fileno, pos)</td></tr>
<tr class="memdesc:a0d43cd441c82e1ab9f347fe0076a44be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This has the task to position the file for reading wave functions at the correct place. It has as arguments the number of the file (corresponding to the node number in the previous calculation) and the index of the wave function in this file. The variable <code>presentfile</code> keeps track of which file is currently open.  <a href="namespacefragments.html#a0d43cd441c82e1ab9f347fe0076a44be">More...</a><br /></td></tr>
<tr class="separator:a0d43cd441c82e1ab9f347fe0076a44be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d35fb12e37d81e53d64e078960a172"><td class="memItemLeft" align="right" valign="top">pure subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#ac2d35fb12e37d81e53d64e078960a172">phases</a> (n, a, c)</td></tr>
<tr class="memdesc:ac2d35fb12e37d81e53d64e078960a172"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates the phase factors for a one-dimensional translation <img class="formulaInl" alt="$ \Delta x $" src="form_132.png"/> as.  <a href="namespacefragments.html#ac2d35fb12e37d81e53d64e078960a172">More...</a><br /></td></tr>
<tr class="separator:ac2d35fb12e37d81e53d64e078960a172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a337f2244c228bf057606a5c5e0758f50"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a337f2244c228bf057606a5c5e0758f50">twobody_init</a></td></tr>
<tr class="memdesc:a337f2244c228bf057606a5c5e0758f50"><td class="mdescLeft">&#160;</td><td class="mdescRight">The purpose of this subroutine is to calculate the boost values from <code>ecm</code> and <code>b</code> in the two-body case. The calculation can be followed with an elementary understanding of the two-body system kinematics, so we just give a brief overview.  <a href="namespacefragments.html#a337f2244c228bf057606a5c5e0758f50">More...</a><br /></td></tr>
<tr class="separator:a337f2244c228bf057606a5c5e0758f50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a270483bd01ad365b6b573dcab2c5fd69"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a270483bd01ad365b6b573dcab2c5fd69">boost_fragment</a> (iff)</td></tr>
<tr class="memdesc:a270483bd01ad365b6b573dcab2c5fd69"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine multiplies the configuration-space wave functions of fragment no. <code>iff</code> by plane-wave factors to give them translational motion.  <a href="namespacefragments.html#a270483bd01ad365b6b573dcab2c5fd69">More...</a><br /></td></tr>
<tr class="separator:a270483bd01ad365b6b573dcab2c5fd69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd17da807067f85598c2cf7d9676c6aa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#afd17da807067f85598c2cf7d9676c6aa">errormsg</a> (msg1, msg2)</td></tr>
<tr class="memdesc:afd17da807067f85598c2cf7d9676c6aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes out error messages.  <a href="namespacefragments.html#afd17da807067f85598c2cf7d9676c6aa">More...</a><br /></td></tr>
<tr class="separator:afd17da807067f85598c2cf7d9676c6aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a135903e4b5b8010a590676f3a88e891e"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a135903e4b5b8010a590676f3a88e891e">fix_boost</a></td></tr>
<tr class="memdesc:a135903e4b5b8010a590676f3a88e891e"><td class="mdescLeft">&#160;</td><td class="mdescRight">if this is set to true, the boost (initial kinetic energy) values are used unchanged from the input; otherwise they are calculated from the initial kinetic energy of relative motion <code>ecm</code> and the impact parameter <code>b</code>. This implies a two-body initial configuration. The initial motion is assumed to be in the <img class="formulaInl" alt="$ (x,z) $" src="form_128.png"/>-plane in this case. Note that for two initial fragments <code>fix_boost</code> can also be set to true for special initial conditions.  <a href="namespacefragments.html#a135903e4b5b8010a590676f3a88e891e">More...</a><br /></td></tr>
<tr class="separator:a135903e4b5b8010a590676f3a88e891e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a2034f9271ef927c98b9ea5a275ec25"><td class="memItemLeft" align="right" valign="top">real(db)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a3a2034f9271ef927c98b9ea5a275ec25">ecm</a></td></tr>
<tr class="memdesc:a3a2034f9271ef927c98b9ea5a275ec25"><td class="mdescLeft">&#160;</td><td class="mdescRight">The kinetic energy of relative motion in MeV.  <a href="namespacefragments.html#a3a2034f9271ef927c98b9ea5a275ec25">More...</a><br /></td></tr>
<tr class="separator:a3a2034f9271ef927c98b9ea5a275ec25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d89da5ba132049038c8105d94063ace"><td class="memItemLeft" align="right" valign="top">real(db)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a1d89da5ba132049038c8105d94063ace">b</a></td></tr>
<tr class="memdesc:a1d89da5ba132049038c8105d94063ace"><td class="mdescLeft">&#160;</td><td class="mdescRight">The impact parameter in fm.  <a href="namespacefragments.html#a1d89da5ba132049038c8105d94063ace">More...</a><br /></td></tr>
<tr class="separator:a1d89da5ba132049038c8105d94063ace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e9374105de36bffebdf008e28c2dd84"><td class="memItemLeft" align="right" valign="top">character(64), dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a6e9374105de36bffebdf008e28c2dd84">filename</a></td></tr>
<tr class="memdesc:a6e9374105de36bffebdf008e28c2dd84"><td class="mdescLeft">&#160;</td><td class="mdescRight">for each fragment this indicates the name of the file with the associated wave functions. One file can be used several times in the case of identical fragments, abut the code does not treat that as a special case.  <a href="namespacefragments.html#a6e9374105de36bffebdf008e28c2dd84">More...</a><br /></td></tr>
<tr class="separator:a6e9374105de36bffebdf008e28c2dd84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3562833581ce4f2cd584e655147309c9"><td class="memItemLeft" align="right" valign="top">real(db), dimension(3, mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a3562833581ce4f2cd584e655147309c9">fcent</a></td></tr>
<tr class="memdesc:a3562833581ce4f2cd584e655147309c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">for fragment no. <code>i</code> the initial three-dimensional position is determined by <code> fcent(:,i) </code>.  <a href="namespacefragments.html#a3562833581ce4f2cd584e655147309c9">More...</a><br /></td></tr>
<tr class="separator:a3562833581ce4f2cd584e655147309c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58edf1cb6f994a8456ed846dc80b56de"><td class="memItemLeft" align="right" valign="top">real(db), dimension(3, mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a58edf1cb6f994a8456ed846dc80b56de">fboost</a></td></tr>
<tr class="memdesc:a58edf1cb6f994a8456ed846dc80b56de"><td class="mdescLeft">&#160;</td><td class="mdescRight">gives the initial motion <code> fboost(:,i)</code> of fragment <code>i</code> in 3 dimensions. This is not a velocity, but the total kinetic energy of the fragment <em> in that Cartesian direction</em> in MeV. The sign indicates the direction, positive or negative along the corresponding axis. The sum of absolute values thus is the total kinetic energy of the fragment. These values are used only if <code>fix_boost</code> is true.  <a href="namespacefragments.html#a58edf1cb6f994a8456ed846dc80b56de">More...</a><br /></td></tr>
<tr class="separator:a58edf1cb6f994a8456ed846dc80b56de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9fc8d9033d9429f8d983bdc0d0131df"><td class="memItemLeft" align="right" valign="top">real(db), dimension(3, mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#ac9fc8d9033d9429f8d983bdc0d0131df">fcmtot</a></td></tr>
<tr class="memdesc:ac9fc8d9033d9429f8d983bdc0d0131df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Centers of mass of the fragments.  <a href="namespacefragments.html#ac9fc8d9033d9429f8d983bdc0d0131df">More...</a><br /></td></tr>
<tr class="separator:ac9fc8d9033d9429f8d983bdc0d0131df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c32760193eb33c1086c2572ff67545b"><td class="memItemLeft" align="right" valign="top">real(db), dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a7c32760193eb33c1086c2572ff67545b">fmass</a></td></tr>
<tr class="memdesc:a7c32760193eb33c1086c2572ff67545b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Masses of the fragments.  <a href="namespacefragments.html#a7c32760193eb33c1086c2572ff67545b">More...</a><br /></td></tr>
<tr class="separator:a7c32760193eb33c1086c2572ff67545b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24689bfc09ecbb7cf75cb613e8821d5b"><td class="memItemLeft" align="right" valign="top">real(db), dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a24689bfc09ecbb7cf75cb613e8821d5b">fcharge</a></td></tr>
<tr class="memdesc:a24689bfc09ecbb7cf75cb613e8821d5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charges of the fragments.  <a href="namespacefragments.html#a24689bfc09ecbb7cf75cb613e8821d5b">More...</a><br /></td></tr>
<tr class="separator:a24689bfc09ecbb7cf75cb613e8821d5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77d67ad7ce22e4fa726ba2a46df254a1"><td class="memItemLeft" align="right" valign="top">integer, dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a77d67ad7ce22e4fa726ba2a46df254a1">fnneut</a></td></tr>
<tr class="memdesc:a77d67ad7ce22e4fa726ba2a46df254a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neutron number of the fragments.  <a href="namespacefragments.html#a77d67ad7ce22e4fa726ba2a46df254a1">More...</a><br /></td></tr>
<tr class="separator:a77d67ad7ce22e4fa726ba2a46df254a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d65ed4cd75c50f289a92b76d7165c7a"><td class="memItemLeft" align="right" valign="top">integer, dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a4d65ed4cd75c50f289a92b76d7165c7a">fnprot</a></td></tr>
<tr class="memdesc:a4d65ed4cd75c50f289a92b76d7165c7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proton number of the fragments.  <a href="namespacefragments.html#a4d65ed4cd75c50f289a92b76d7165c7a">More...</a><br /></td></tr>
<tr class="separator:a4d65ed4cd75c50f289a92b76d7165c7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43fdb4c115fabc2de7179b58d87e83d2"><td class="memItemLeft" align="right" valign="top">integer, dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a43fdb4c115fabc2de7179b58d87e83d2">fnstmax</a></td></tr>
<tr class="memdesc:a43fdb4c115fabc2de7179b58d87e83d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last index number of the wave functions of the fragments.  <a href="namespacefragments.html#a43fdb4c115fabc2de7179b58d87e83d2">More...</a><br /></td></tr>
<tr class="separator:a43fdb4c115fabc2de7179b58d87e83d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a6f623e09218453f325f0683479b238"><td class="memItemLeft" align="right" valign="top">integer, dimension(2, mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a2a6f623e09218453f325f0683479b238">fnpmin</a></td></tr>
<tr class="memdesc:a2a6f623e09218453f325f0683479b238"><td class="mdescLeft">&#160;</td><td class="mdescRight">First index numbers for protons and neutrons of the fragments.  <a href="namespacefragments.html#a2a6f623e09218453f325f0683479b238">More...</a><br /></td></tr>
<tr class="separator:a2a6f623e09218453f325f0683479b238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a382e921652dbd2ce11044e710de9e9d3"><td class="memItemLeft" align="right" valign="top">integer, dimension(2, mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a382e921652dbd2ce11044e710de9e9d3">fnpsi</a></td></tr>
<tr class="memdesc:a382e921652dbd2ce11044e710de9e9d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last index numbers for protons and neutrons of the fragments.  <a href="namespacefragments.html#a382e921652dbd2ce11044e710de9e9d3">More...</a><br /></td></tr>
<tr class="separator:a382e921652dbd2ce11044e710de9e9d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8860efcb50f5f30f1b09b56ddbcf0593"><td class="memItemLeft" align="right" valign="top">integer, dimension(2, mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a8860efcb50f5f30f1b09b56ddbcf0593">fnumber</a></td></tr>
<tr class="memdesc:a8860efcb50f5f30f1b09b56ddbcf0593"><td class="mdescLeft">&#160;</td><td class="mdescRight">gives the number of wave functions in the fragment for each isospin. For initialization of a dynamic calculation only wave functions with a nonzero occupation are taken into account.  <a href="namespacefragments.html#a8860efcb50f5f30f1b09b56ddbcf0593">More...</a><br /></td></tr>
<tr class="separator:a8860efcb50f5f30f1b09b56ddbcf0593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7039bb57bcdb504b17adf7afee644643"><td class="memItemLeft" align="right" valign="top">integer, dimension(2, mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a7039bb57bcdb504b17adf7afee644643">fnewnpmin</a></td></tr>
<tr class="memdesc:a7039bb57bcdb504b17adf7afee644643"><td class="mdescLeft">&#160;</td><td class="mdescRight">are the starting indices for each fragment's wave functions in the total set of wave functions combining all the fragments.  <a href="namespacefragments.html#a7039bb57bcdb504b17adf7afee644643">More...</a><br /></td></tr>
<tr class="separator:a7039bb57bcdb504b17adf7afee644643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea59819a3bf02055e7da3fb78204059b"><td class="memItemLeft" align="right" valign="top">integer, dimension(2, mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#aea59819a3bf02055e7da3fb78204059b">fnewnpsi</a></td></tr>
<tr class="memdesc:aea59819a3bf02055e7da3fb78204059b"><td class="mdescLeft">&#160;</td><td class="mdescRight">are the ending indices for each fragment's wave functions in the total set of wave functions combining all the fragments.  <a href="namespacefragments.html#aea59819a3bf02055e7da3fb78204059b">More...</a><br /></td></tr>
<tr class="separator:aea59819a3bf02055e7da3fb78204059b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cbd8b4a5d07380c633c2192ba583e57"><td class="memItemLeft" align="right" valign="top">integer, dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a7cbd8b4a5d07380c633c2192ba583e57">fnx</a></td></tr>
<tr class="memdesc:a7cbd8b4a5d07380c633c2192ba583e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">indicate the grid size in x-direction on which the fragment wave functions are defined.  <a href="namespacefragments.html#a7cbd8b4a5d07380c633c2192ba583e57">More...</a><br /></td></tr>
<tr class="separator:a7cbd8b4a5d07380c633c2192ba583e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b8a0d5d20c7f29c604a32d3e872f88e"><td class="memItemLeft" align="right" valign="top">integer, dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a6b8a0d5d20c7f29c604a32d3e872f88e">fny</a></td></tr>
<tr class="memdesc:a6b8a0d5d20c7f29c604a32d3e872f88e"><td class="mdescLeft">&#160;</td><td class="mdescRight">indicate the grid size in y-direction on which the fragment wave functions are defined.  <a href="namespacefragments.html#a6b8a0d5d20c7f29c604a32d3e872f88e">More...</a><br /></td></tr>
<tr class="separator:a6b8a0d5d20c7f29c604a32d3e872f88e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0ceb837dcb0ece927f23c31c6e7277"><td class="memItemLeft" align="right" valign="top">integer, dimension(mnof)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefragments.html#a5b0ceb837dcb0ece927f23c31c6e7277">fnz</a></td></tr>
<tr class="memdesc:a5b0ceb837dcb0ece927f23c31c6e7277"><td class="mdescLeft">&#160;</td><td class="mdescRight">indicate the grid size in z-direction on which the fragment wave functions are defined.  <a href="namespacefragments.html#a5b0ceb837dcb0ece927f23c31c6e7277">More...</a><br /></td></tr>
<tr class="separator:a5b0ceb837dcb0ece927f23c31c6e7277"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module is concerned with setting up the initial condition from data files containing fragment wave functions, usually obtained in a previous static calculation. </p>
<p>A typical application is the initialization of a heavy-ion reaction. Beyond that, any number of fragments (limited by the parameter variable <code>mnof</code>) can be put into the grid at prescribed positions with given initial velocities. A condition is, however, that the grid they are defined in is smaller than the new grid. If they are put close to the boundary, they may have density appearing on the other side because of periodicity; this may be acceptable if the boundary condition is periodic. A calculation may be restarted on a larger grid, but this may be accompanied by some loss of accuracy, since the wave function outside the original regions is set to a constant small value.</p>
<p>For the case of parallel <code>MPI</code> calculations, there is logic to read wave functions distributed over a series of files as described in connection with subroutine <code>write_wavefunctions</code>. Since only the dynamic case can run under <code>MPI</code> at present, the only application of this is to restart a dynamic calculation. The number of processors may be different in the restart. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a270483bd01ad365b6b573dcab2c5fd69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a270483bd01ad365b6b573dcab2c5fd69">&#9670;&nbsp;</a></span>boost_fragment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fragments::boost_fragment </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iff</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This subroutine multiplies the configuration-space wave functions of fragment no. <code>iff</code> by plane-wave factors to give them translational motion. </p>
<p>This is done by calculating the wave number vector <code>akf</code> from the kinetic energy. There is one subtle point: since the boost is applied to <em> single-particle</em> wave functions, the momentum <img class="formulaInl" alt="$ k $" src="form_17.png"/> should be the correct one for <em> one nucleon </em>. Thus the total kinetic energy of the fragment is </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T=A\frac{\hbar^2}{2m}k^2, \]" src="form_136.png"/>
</p>
<p> where <img class="formulaInl" alt="$ A $" src="form_137.png"/> is the mass number of the fragment and <img class="formulaInl" alt="$ m $" src="form_138.png"/> the nucleon mass. Solving for <img class="formulaInl" alt="$ k $" src="form_17.png"/> and taking the sign into account yields the expression in the code.</p>
<p>The rest is then straightforward.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iff</td><td>INTEGER, takes the number of the fragment to be boosted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afd17da807067f85598c2cf7d9676c6aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd17da807067f85598c2cf7d9676c6aa">&#9670;&nbsp;</a></span>errormsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fragments::errormsg </td>
          <td>(</td>
          <td class="paramtype">character(*), intent(in)&#160;</td>
          <td class="paramname"><em>msg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in)&#160;</td>
          <td class="paramname"><em>msg2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes out error messages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg1</td><td>CHARACTER, array, takes the first message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg2</td><td>CHARACTER, array, takes the second message. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acd40a2830b84a9a5defb0691a84747b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd40a2830b84a9a5defb0691a84747b2">&#9670;&nbsp;</a></span>getin_fragments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fragments::getin_fragments</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine reads the input variables, makes some consistency checks, and then prepares for the initialization. </p>
<p>A restart is set up by placing one fragment taken from <code>wffile</code> at the origin with zero velocity.</p>
<p>The main loop is over fragments. The fragment files are opened a first time to obtain information about the fragments, which is stored in fragment-specific arrays. The checks include agreement of the forces and grid spacings as well as that the fragment grid is not larger than the new grid.</p>
<p>The code at this point makes a distinction between static and dynamic modes: for a static calculation it is assumed that the data may be needed for a restart. In this case all wave functions are read in even if not occupied even fractionally. For the dynamic case only those with non-zero occupation are input as determined from <code>fwocc</code>. This yields a reduced value for <code>fnumber</code>.</p>
<p><b> Note that at present it is assumed that the static wave functions are ordered in ascending energy, so that the occupied ones will start at index one and all empty states will be at the uppermost index positions.</b></p>
<p>Following this, the index positions in the new wave function array are calculated in <code>fnewnpmin</code> and <code>fnewnpsi</code> by adding the numbers of wave functions of each fragment-specific successively. Note that at this stage the proton indices are still counted from one.</p>
<p>After this input loop, the indices <code>npmin</code> and <code>npsi</code> as well as the total number <code>nstmax</code> for the combined system are calculated and finally the proton indices where the fragment wave functions should be inserted are shifted to behind the neutrons, i.e., starting at <code>npmin(2)</code>.</p>
<p>At the end the two-body initialization <code>twobody_init</code> is called for the dynamic case with two fragments and <code> fix_boost=.FALSE.</code>. This calculates the <code>fboost</code> values from <code>ecm</code> and <code>b</code>. </p>

</div>
</div>
<a id="a0d43cd441c82e1ab9f347fe0076a44be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d43cd441c82e1ab9f347fe0076a44be">&#9670;&nbsp;</a></span>locate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, private fragments::locate </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This has the task to position the file for reading wave functions at the correct place. It has as arguments the number of the file (corresponding to the node number in the previous calculation) and the index of the wave function in this file. The variable <code>presentfile</code> keeps track of which file is currently open. </p>
<p>If we are starting to read a new file (which is always true initially, as no wave functions are written into the header file <code>wffile</code> itself), it closes the present file, composes the file name for the new one and opens it. Then the proper number of records are ignored to position at the correct one. If the file has not changed, it simply returns and reading continues sequentially. The logic of course assumes that files are stored sequentially in each partial file, but the division into partial files need not be the same as in the previous run.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileno</td><td>INTEGER, takes the number of the file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pos</td><td>INTEGER, takes the index of the wave function in this file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac2d35fb12e37d81e53d64e078960a172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2d35fb12e37d81e53d64e078960a172">&#9670;&nbsp;</a></span>phases()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, private fragments::phases </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(db), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(db), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This subroutine calculates the phase factors for a one-dimensional translation <img class="formulaInl" alt="$ \Delta x $" src="form_132.png"/> as. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \exp\left(-\frac{2\pi\I k_j \Delta x}{L}\right). \]" src="form_133.png"/>
</p>
<p>The shift was calculated in <code>read_one_fragment</code>, the argument <code>c</code> includes a denominator <img class="formulaInl" alt="$ L={\tt nx*dx} $" src="form_134.png"/>, the total length of the grid. The momentum <img class="formulaInl" alt="$ k_j $" src="form_135.png"/> is determined in the usual way for the finite Fourier transform.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>INTEGER, takes the number of grid points. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a</td><td>COMPLEX(db), array, returns the phases. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>REAL(db), takes the shift <br  />
 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a60355fb212340bf2d5988af3d9354967"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60355fb212340bf2d5988af3d9354967">&#9670;&nbsp;</a></span>read_fragments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fragments::read_fragments</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine prints summary information about which fragment wave functions occupy which range of indices. Then it does a loop over fragments to read in their wave functions using <code>read_one_fragment</code>, followed by applying the boost to them using <code>boost_fragment</code>. </p>

</div>
</div>
<a id="ace60d8e2552ba0068385e7195f2876c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace60d8e2552ba0068385e7195f2876c4">&#9670;&nbsp;</a></span>read_one_fragment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fragments::read_one_fragment </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iff</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This subroutine reopens a fragment file for the fragment indexed by <code>iff</code> and reads the wave functions, inserting them at the correct index into the new wave function array while also moving them to the desired center-of-mass position. </p>
<p>The principal loop is over isospin. The index limits in the fragment file for that isospin are put into <code>il</code> and <code>iu</code>, and the new indices into <code>newil</code> and <code>newiu</code>. In the next step the grid coordinates and the single-particle quantities are read. The latter are copied into the new arrays and the isospin is also recorded. Then this information is printed.</p>
<p>Once this loop is concluded, the spatial shift is prepared. The shift is calculated from the difference between the desired position <code>fcent</code> with respect to the origin of the new coordinates given by <code>x</code> etc., and the fragment center-of-mass <code>fcmtot</code> with respect to the origin in fragment coordinates <code>fx</code> etc. Subroutine <code>phases</code> is used to calculate essentially the shift phase factor <img class="formulaInl" alt="$ \exp(-\I\vec k\cdot\Delta\vec r) $" src="form_129.png"/>, which is a product of phases in each coordinate direction <code>akx</code>, <code>aky</code>, and <code>akz</code>. These have an index corresponding to <img class="formulaInl" alt="$ \vec k $" src="form_130.png"/> in the Fourier transform.</p>
<p>Now the index arrays <code>fnode</code> and <code>flocalindex</code> are read, which indicate where the wave functions are to be found in case of an MPI job. The logical variable <code>multifile</code> records whether this is the case by testing whether any of the wave functions was stored on other than node 0.</p>
<p>The following loop runs over the new index positions. If the wave function is not on the current node, nothing is done except for ignoring the input record.</p>
<p>For the case of multiple files for one fragment (which is recognized by not all the indices <code>fnode</code> being zero, a short subroutine <code>locate</code> is used to position input at the correct location.</p>
<p>Otherwise the wave function is read from the fragment file using the fragment grid dimensions into a variable <code>ps1</code> defined with the full new dimension, then it is Fourier transformed, multiplied by the phase factor, and transformed back. Finally it is inserted into the total wave function array <code>psi</code>, where any zeroes are replaced by a small number, presently set to <img class="formulaInl" alt="$ 10^{-20} $" src="form_131.png"/>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iff</td><td>INTEGER, takes the umber of the fragment which is read in. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a337f2244c228bf057606a5c5e0758f50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a337f2244c228bf057606a5c5e0758f50">&#9670;&nbsp;</a></span>twobody_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fragments::twobody_init</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The purpose of this subroutine is to calculate the boost values from <code>ecm</code> and <code>b</code> in the two-body case. The calculation can be followed with an elementary understanding of the two-body system kinematics, so we just give a brief overview. </p>
<p>The reduced mass <code>xmu</code>, the relative velocity <code>vrel</code> and the angular momentum <code>xli</code> are calculated first. Then the components of the vector linking the two centers of mass <code>dix</code> and <code>diz</code> are divided by the length of this vector <code>roft</code> to get the direction cosines.</p>
<p>The Coulomb energy is calculated assuming two point charges at distance <code>roft</code> and is subtracted from <code>ecm</code> to yield the kinetic energy remaining at this distance, from which the relative velocity <code>vrel_d</code> is calculated. Since the total center of mass is assumed to be at rest, the velocities of the fragments <code>v1</code> and <code>v2</code> can then be simply obtained. The instantaneous impact parameter <code>b_d</code> results from the angular momentum and the relative velocity, and the angle by which the two fragments need to miss each other in order to realize this impact parameter is computed in <code>sint</code> and <code>cost</code>.</p>
<p>This now makes it possible to calculate the boost velocity components, which are converted into kinetic energies to conform to the definition of <code>fboost</code> as given in the input. Note that these energies are signed to indicate the direction of motion.</p>
<p>Both velocities and energies are printed. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1d89da5ba132049038c8105d94063ace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d89da5ba132049038c8105d94063ace">&#9670;&nbsp;</a></span>b</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db) fragments::b</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The impact parameter in fm. </p>

</div>
</div>
<a id="a3a2034f9271ef927c98b9ea5a275ec25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a2034f9271ef927c98b9ea5a275ec25">&#9670;&nbsp;</a></span>ecm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db) fragments::ecm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The kinetic energy of relative motion in MeV. </p>

</div>
</div>
<a id="a58edf1cb6f994a8456ed846dc80b56de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58edf1cb6f994a8456ed846dc80b56de">&#9670;&nbsp;</a></span>fboost</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(3,mnof) fragments::fboost</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>gives the initial motion <code> fboost(:,i)</code> of fragment <code>i</code> in 3 dimensions. This is not a velocity, but the total kinetic energy of the fragment <em> in that Cartesian direction</em> in MeV. The sign indicates the direction, positive or negative along the corresponding axis. The sum of absolute values thus is the total kinetic energy of the fragment. These values are used only if <code>fix_boost</code> is true. </p>

</div>
</div>
<a id="a3562833581ce4f2cd584e655147309c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3562833581ce4f2cd584e655147309c9">&#9670;&nbsp;</a></span>fcent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(3,mnof) fragments::fcent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>for fragment no. <code>i</code> the initial three-dimensional position is determined by <code> fcent(:,i) </code>. </p>

</div>
</div>
<a id="a24689bfc09ecbb7cf75cb613e8821d5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24689bfc09ecbb7cf75cb613e8821d5b">&#9670;&nbsp;</a></span>fcharge</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(mnof) fragments::fcharge</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Charges of the fragments. </p>

</div>
</div>
<a id="ac9fc8d9033d9429f8d983bdc0d0131df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9fc8d9033d9429f8d983bdc0d0131df">&#9670;&nbsp;</a></span>fcmtot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(3,mnof) fragments::fcmtot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Centers of mass of the fragments. </p>

</div>
</div>
<a id="a6e9374105de36bffebdf008e28c2dd84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e9374105de36bffebdf008e28c2dd84">&#9670;&nbsp;</a></span>filename</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(64), dimension(mnof) fragments::filename</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>for each fragment this indicates the name of the file with the associated wave functions. One file can be used several times in the case of identical fragments, abut the code does not treat that as a special case. </p>

</div>
</div>
<a id="a135903e4b5b8010a590676f3a88e891e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a135903e4b5b8010a590676f3a88e891e">&#9670;&nbsp;</a></span>fix_boost</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical fragments::fix_boost</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>if this is set to true, the boost (initial kinetic energy) values are used unchanged from the input; otherwise they are calculated from the initial kinetic energy of relative motion <code>ecm</code> and the impact parameter <code>b</code>. This implies a two-body initial configuration. The initial motion is assumed to be in the <img class="formulaInl" alt="$ (x,z) $" src="form_128.png"/>-plane in this case. Note that for two initial fragments <code>fix_boost</code> can also be set to true for special initial conditions. </p>

</div>
</div>
<a id="a7c32760193eb33c1086c2572ff67545b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c32760193eb33c1086c2572ff67545b">&#9670;&nbsp;</a></span>fmass</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(db), dimension(mnof) fragments::fmass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Masses of the fragments. </p>

</div>
</div>
<a id="a7039bb57bcdb504b17adf7afee644643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7039bb57bcdb504b17adf7afee644643">&#9670;&nbsp;</a></span>fnewnpmin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2,mnof) fragments::fnewnpmin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>are the starting indices for each fragment's wave functions in the total set of wave functions combining all the fragments. </p>

</div>
</div>
<a id="aea59819a3bf02055e7da3fb78204059b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea59819a3bf02055e7da3fb78204059b">&#9670;&nbsp;</a></span>fnewnpsi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2,mnof) fragments::fnewnpsi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>are the ending indices for each fragment's wave functions in the total set of wave functions combining all the fragments. </p>

</div>
</div>
<a id="a77d67ad7ce22e4fa726ba2a46df254a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77d67ad7ce22e4fa726ba2a46df254a1">&#9670;&nbsp;</a></span>fnneut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(mnof) fragments::fnneut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Neutron number of the fragments. </p>

</div>
</div>
<a id="a2a6f623e09218453f325f0683479b238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a6f623e09218453f325f0683479b238">&#9670;&nbsp;</a></span>fnpmin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2,mnof) fragments::fnpmin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First index numbers for protons and neutrons of the fragments. </p>

</div>
</div>
<a id="a4d65ed4cd75c50f289a92b76d7165c7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d65ed4cd75c50f289a92b76d7165c7a">&#9670;&nbsp;</a></span>fnprot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(mnof) fragments::fnprot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Proton number of the fragments. </p>

</div>
</div>
<a id="a382e921652dbd2ce11044e710de9e9d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a382e921652dbd2ce11044e710de9e9d3">&#9670;&nbsp;</a></span>fnpsi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2,mnof) fragments::fnpsi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last index numbers for protons and neutrons of the fragments. </p>

</div>
</div>
<a id="a43fdb4c115fabc2de7179b58d87e83d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43fdb4c115fabc2de7179b58d87e83d2">&#9670;&nbsp;</a></span>fnstmax</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(mnof) fragments::fnstmax</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last index number of the wave functions of the fragments. </p>

</div>
</div>
<a id="a8860efcb50f5f30f1b09b56ddbcf0593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8860efcb50f5f30f1b09b56ddbcf0593">&#9670;&nbsp;</a></span>fnumber</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(2,mnof) fragments::fnumber</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>gives the number of wave functions in the fragment for each isospin. For initialization of a dynamic calculation only wave functions with a nonzero occupation are taken into account. </p>

</div>
</div>
<a id="a7cbd8b4a5d07380c633c2192ba583e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cbd8b4a5d07380c633c2192ba583e57">&#9670;&nbsp;</a></span>fnx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(mnof) fragments::fnx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>indicate the grid size in x-direction on which the fragment wave functions are defined. </p>

</div>
</div>
<a id="a6b8a0d5d20c7f29c604a32d3e872f88e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b8a0d5d20c7f29c604a32d3e872f88e">&#9670;&nbsp;</a></span>fny</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(mnof) fragments::fny</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>indicate the grid size in y-direction on which the fragment wave functions are defined. </p>

</div>
</div>
<a id="a5b0ceb837dcb0ece927f23c31c6e7277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0ceb837dcb0ece927f23c31c6e7277">&#9670;&nbsp;</a></span>fnz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(mnof) fragments::fnz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>indicate the grid size in z-direction on which the fragment wave functions are defined. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefragments.html">fragments</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
