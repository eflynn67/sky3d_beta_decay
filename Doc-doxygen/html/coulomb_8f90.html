<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sky3D: coulomb.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sky3D
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('coulomb_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">coulomb.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacecoulomb"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html">coulomb</a></td></tr>
<tr class="memdesc:namespacecoulomb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module offers the subroutine <code>poisson</code>, which calculates the Coulomb potential from the proton density. The two boundary conditions allowed are distinguished by the value of the variable periodic. If it is true, the mesh is assumed to be periodic in all three directions and the Poisson equation is solved using the <img class="formulaInl" alt="$\frac{1}{k^2}$" src="form_0.png"/> Green’s function in momentum space and assuming a homogeneous negative background annulling the total charge (jellium approximation). Otherwise the boundary condition is for an isolated charge distribution. In this case the potential is calculated by the method of doubling the grid in all directions with zero density, folding with the 1/r-potential in momentum space and then restricting to the physical region. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5f0400055fa5aa4cbfc054c9e1bf565b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#a5f0400055fa5aa4cbfc054c9e1bf565b">coulomb::poisson</a> (rhocharge)</td></tr>
<tr class="memdesc:a5f0400055fa5aa4cbfc054c9e1bf565b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine solves the Poisson equation by the Fourier method.  <a href="namespacecoulomb.html#a5f0400055fa5aa4cbfc054c9e1bf565b">More...</a><br /></td></tr>
<tr class="separator:a5f0400055fa5aa4cbfc054c9e1bf565b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74649b61a8f2de130fb95edb9a62d498"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#a74649b61a8f2de130fb95edb9a62d498">coulomb::coulinit</a></td></tr>
<tr class="memdesc:a74649b61a8f2de130fb95edb9a62d498"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine does the necessary initialization.  <a href="namespacecoulomb.html#a74649b61a8f2de130fb95edb9a62d498">More...</a><br /></td></tr>
<tr class="separator:a74649b61a8f2de130fb95edb9a62d498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee5145182fc0abb626eaa2850a87826c"><td class="memItemLeft" align="right" valign="top">subroutine, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#aee5145182fc0abb626eaa2850a87826c">coulomb::initiq</a> (n, d, iq)</td></tr>
<tr class="memdesc:aee5145182fc0abb626eaa2850a87826c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates the contributions of each Cartesian index to <img class="formulaInl" alt="$r^2$" src="form_34.png"/> and <img class="formulaInl" alt="$k^{-2}$" src="form_35.png"/>.  <a href="namespacecoulomb.html#aee5145182fc0abb626eaa2850a87826c">More...</a><br /></td></tr>
<tr class="separator:aee5145182fc0abb626eaa2850a87826c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a26740de741e0c1efe01fe26e5c996135"><td class="memItemLeft" align="right" valign="top">real(db), dimension(:,:,:), allocatable, save, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#a26740de741e0c1efe01fe26e5c996135">coulomb::wcoul</a></td></tr>
<tr class="memdesc:a26740de741e0c1efe01fe26e5c996135"><td class="mdescLeft">&#160;</td><td class="mdescRight"><br  />
  <a href="namespacecoulomb.html#a26740de741e0c1efe01fe26e5c996135">More...</a><br /></td></tr>
<tr class="separator:a26740de741e0c1efe01fe26e5c996135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9f62c9032d70f15617f01a0c9ecb0c7"><td class="memItemLeft" align="right" valign="top">complex(db), dimension(:,:,:), allocatable, save, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#ad9f62c9032d70f15617f01a0c9ecb0c7">coulomb::q</a></td></tr>
<tr class="memdesc:ad9f62c9032d70f15617f01a0c9ecb0c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">array for the complex Green’s function (isolated) or array of 1/r values. Its dimension also depends on the boundary condition.  <a href="namespacecoulomb.html#ad9f62c9032d70f15617f01a0c9ecb0c7">More...</a><br /></td></tr>
<tr class="separator:ad9f62c9032d70f15617f01a0c9ecb0c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Dimensions of the grid on which the Fourier transform is calculated.</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>For the periodic case they are identical to the regular dimensions, for the isolated case they are doubled. </p>
</div></td></tr>
<tr class="memitem:a821f17159bc941612225823801555733"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#a821f17159bc941612225823801555733">coulomb::nx2</a></td></tr>
<tr class="separator:a821f17159bc941612225823801555733"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5bb921ae0a248b7ce45c157e9d793d"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#aec5bb921ae0a248b7ce45c157e9d793d">coulomb::ny2</a></td></tr>
<tr class="separator:aec5bb921ae0a248b7ce45c157e9d793d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de0e5b7d18f4ce88eeb7ea25839149a"><td class="memItemLeft" align="right" valign="top">integer, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#a0de0e5b7d18f4ce88eeb7ea25839149a">coulomb::nz2</a></td></tr>
<tr class="separator:a0de0e5b7d18f4ce88eeb7ea25839149a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Plans for FFTW complex forward and reverse transforms</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>with array dimensions depending on the boundary condition. </p>
</div></td></tr>
<tr class="memitem:a20877fe904a19406549cfc1e10b30128"><td class="memItemLeft" align="right" valign="top">integer(c_long), save, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#a20877fe904a19406549cfc1e10b30128">coulomb::coulplan1</a></td></tr>
<tr class="separator:a20877fe904a19406549cfc1e10b30128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd1cdc755ebb2f0adcd1d1ce1cf4503"><td class="memItemLeft" align="right" valign="top">integer(c_long), save, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecoulomb.html#abfd1cdc755ebb2f0adcd1d1ce1cf4503">coulomb::coulplan2</a></td></tr>
<tr class="separator:abfd1cdc755ebb2f0adcd1d1ce1cf4503"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_23fdee2f6995db16c755697cdf620cf4.html">Code</a></li><li class="navelem"><a class="el" href="coulomb_8f90.html">coulomb.f90</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
