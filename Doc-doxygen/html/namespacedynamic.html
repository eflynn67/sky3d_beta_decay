<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sky3D: dynamic Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sky3D
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacedynamic.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">dynamic Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains the routines needed for time propagation of the system. All the logic needed for this case is concentrated here; all other modules except for <code>External</code> are equally used in the static calculation.  
<a href="namespacedynamic.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a25a35b2c3f00abafa02b49fae36b450c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a25a35b2c3f00abafa02b49fae36b450c">getin_dynamic</a></td></tr>
<tr class="memdesc:a25a35b2c3f00abafa02b49fae36b450c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a relatively simple routine that reads the input for namelist <code>dynamic</code> and prints it on standard output. If <code>texternal</code> is true, it also calls <code>getin_external</code> to read the external field parameters.  <a href="namespacedynamic.html#a25a35b2c3f00abafa02b49fae36b450c">More...</a><br /></td></tr>
<tr class="separator:a25a35b2c3f00abafa02b49fae36b450c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05d4cb5b6f8395bbda511e5a937b317a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a05d4cb5b6f8395bbda511e5a937b317a">dynamichf</a></td></tr>
<tr class="memdesc:a05d4cb5b6f8395bbda511e5a937b317a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine performs the main time-integration algorithm starting at time step 0 and then iterating the desired number of steps.  <a href="namespacedynamic.html#a05d4cb5b6f8395bbda511e5a937b317a">More...</a><br /></td></tr>
<tr class="separator:a05d4cb5b6f8395bbda511e5a937b317a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d48d0e156e217e9e42654cb7189912"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a67d48d0e156e217e9e42654cb7189912">tstep</a> (iq, mxp, psout)</td></tr>
<tr class="memdesc:a67d48d0e156e217e9e42654cb7189912"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this subroutine one wave function given as the argument <code>psout</code> is stepped forward in time by the interval <code>dt</code>.  <a href="namespacedynamic.html#a67d48d0e156e217e9e42654cb7189912">More...</a><br /></td></tr>
<tr class="separator:a67d48d0e156e217e9e42654cb7189912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc79414314504771509e8982faefe77b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#acc79414314504771509e8982faefe77b">tinfo</a></td></tr>
<tr class="memdesc:acc79414314504771509e8982faefe77b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is used to output various pieces of information relevant especially to the dynamic mode of the code.  <a href="namespacedynamic.html#acc79414314504771509e8982faefe77b">More...</a><br /></td></tr>
<tr class="separator:acc79414314504771509e8982faefe77b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad225fa83cc6ff167d9a63f234e32ae1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#aad225fa83cc6ff167d9a63f234e32ae1">resetcm</a></td></tr>
<tr class="memdesc:aad225fa83cc6ff167d9a63f234e32ae1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine resets the center-of-mass velocity to zero.  <a href="namespacedynamic.html#aad225fa83cc6ff167d9a63f234e32ae1">More...</a><br /></td></tr>
<tr class="separator:aad225fa83cc6ff167d9a63f234e32ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a082deb2f0c47a60e4e2ef2dc1ce395e6"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a082deb2f0c47a60e4e2ef2dc1ce395e6">nt</a></td></tr>
<tr class="memdesc:a082deb2f0c47a60e4e2ef2dc1ce395e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">the number of the final time step to be calculated. In case of a restart this is smaller than the total number of time steps.  <a href="namespacedynamic.html#a082deb2f0c47a60e4e2ef2dc1ce395e6">More...</a><br /></td></tr>
<tr class="separator:a082deb2f0c47a60e4e2ef2dc1ce395e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f8a4fbc7fad45d168c880b0f7fbebf9"><td class="memItemLeft" align="right" valign="top">real(db)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a2f8a4fbc7fad45d168c880b0f7fbebf9">dt</a></td></tr>
<tr class="memdesc:a2f8a4fbc7fad45d168c880b0f7fbebf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">the physical time increment in units of fm/c.  <a href="namespacedynamic.html#a2f8a4fbc7fad45d168c880b0f7fbebf9">More...</a><br /></td></tr>
<tr class="separator:a2f8a4fbc7fad45d168c880b0f7fbebf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28058983e8491350fbbeaa9cd1c03a1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#ab28058983e8491350fbbeaa9cd1c03a1">mxpact</a> =6</td></tr>
<tr class="memdesc:ab28058983e8491350fbbeaa9cd1c03a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">the number of terms to be taken in the expansion of the potential  <a href="namespacedynamic.html#ab28058983e8491350fbbeaa9cd1c03a1">More...</a><br /></td></tr>
<tr class="separator:ab28058983e8491350fbbeaa9cd1c03a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22bc0055a5dfc3e92580a8697a8ab1ef"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a22bc0055a5dfc3e92580a8697a8ab1ef">mrescm</a> =0</td></tr>
<tr class="memdesc:a22bc0055a5dfc3e92580a8697a8ab1ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">frequency of c.m. motion correction  <a href="namespacedynamic.html#a22bc0055a5dfc3e92580a8697a8ab1ef">More...</a><br /></td></tr>
<tr class="separator:a22bc0055a5dfc3e92580a8697a8ab1ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f66cf733898b4e6596541c4665bb503"><td class="memItemLeft" align="right" valign="top">real(db)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a8f66cf733898b4e6596541c4665bb503">rsep</a></td></tr>
<tr class="memdesc:a8f66cf733898b4e6596541c4665bb503"><td class="mdescLeft">&#160;</td><td class="mdescRight">the final separation distance. The calculation is stopped if there has been a reseparation into two fragments and their distance exceeds <code>rsep</code>.  <a href="namespacedynamic.html#a8f66cf733898b4e6596541c4665bb503">More...</a><br /></td></tr>
<tr class="separator:a8f66cf733898b4e6596541c4665bb503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c78ad5d4b68b5815c853cf157e875a8"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a9c78ad5d4b68b5815c853cf157e875a8">texternal</a> =.FALSE.</td></tr>
<tr class="memdesc:a9c78ad5d4b68b5815c853cf157e875a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">this logical variable indicates that an external field is present. See module <code>External</code>.  <a href="namespacedynamic.html#a9c78ad5d4b68b5815c853cf157e875a8">More...</a><br /></td></tr>
<tr class="separator:a9c78ad5d4b68b5815c853cf157e875a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b0110fc909c9bf8bc9878b8a0afe0cf"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#a1b0110fc909c9bf8bc9878b8a0afe0cf">text_timedep</a></td></tr>
<tr class="memdesc:a1b0110fc909c9bf8bc9878b8a0afe0cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">this logical variable indicates that the external field is time-dependent and does not describe an instantaneous boost.  <a href="namespacedynamic.html#a1b0110fc909c9bf8bc9878b8a0afe0cf">More...</a><br /></td></tr>
<tr class="separator:a1b0110fc909c9bf8bc9878b8a0afe0cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab70ac1e2a79efd1c86cfefc148f67593"><td class="memItemLeft" align="right" valign="top">real(db), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedynamic.html#ab70ac1e2a79efd1c86cfefc148f67593">esf</a> =0.0D0</td></tr>
<tr class="memdesc:ab70ac1e2a79efd1c86cfefc148f67593"><td class="mdescLeft">&#160;</td><td class="mdescRight">this is the energy shift for the call to <code>hpsi</code>. Since it is not used in the dynamics part of the code, it is here set to the constant value of zero.  <a href="namespacedynamic.html#ab70ac1e2a79efd1c86cfefc148f67593">More...</a><br /></td></tr>
<tr class="separator:ab70ac1e2a79efd1c86cfefc148f67593"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains the routines needed for time propagation of the system. All the logic needed for this case is concentrated here; all other modules except for <code>External</code> are equally used in the static calculation. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a05d4cb5b6f8395bbda511e5a937b317a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05d4cb5b6f8395bbda511e5a937b317a">&#9670;&nbsp;</a></span>dynamichf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dynamic::dynamichf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine performs the main time-integration algorithm starting at time step 0 and then iterating the desired number of steps. </p>
<p>Its building blocks are:</p><ul>
<li><b> Step 1: preparation phase:</b> this phase consists of several substeps.<ol type="1">
<li>If this is not a restart, the time and iteration number are zeroed (for a restart only the physical time is taken from the <code>wffile</code>). The wave functions are saved in the <code>wffile</code>, to save setup time in case the calculation has to be restarted from this initial point.</li>
<li>The instantaneous external boost is applied using <code>extboost</code>. If this subroutine has applied a boost, it sets <code>text_timedep</code> to <code></code>.FALSE. so no further calls to external-field routines are made (except for <code>print_extfield</code>).</li>
<li>The protocol files <code> *.res </code> are initialized with their header lines. <br  />
</li>
<li>The densities and current are calculated in a loop over wave function by calling <code>add_densities</code>. They are first set to zero and then accumulated in a loop over the set on the local node, followed by collecting them over all nodes.</li>
<li>The mean field and (if <code>texternal</code> is true) the external field are calculated for time zero using routines <code>skyrme</code> and <code>extfld</code>.</li>
<li>Then <code>tinfo</code> is called to calculate and print the single-particle quantities and the total energies at time 0 or iteration 0.</li>
<li>Finally preparations are made for the time-stepping loop: the starting index is set to <code>iter+1</code>: this is either after the end of a previous job in the case of a restart, or just one for a new calculation. The physical time is either 0 or the time taken from a restart file.</li>
</ol>
</li>
<li><b> Step 2: predictor time step:</b> the loop over the iteration index <code>iter</code> is started. Then the densities and mean-field components are estimated, i. e., in effect the Hamiltonian <img class="formulaInl" alt="$ \hat h(t+\tfrac1{2}\Delta t) $" src="form_51.png"/> required by the numerical method. This is done by evolving the wave functions for a full <code>dt</code> using the old Hamiltonian and averaging the densities between old and new ones to obtain the mid-time Hamiltonian for propagation. In detail the procedure is as follows:<ol type="1">
<li>The densities are not set to zero in order to allow adding the contributions of the wave functions at the end of the time step.</li>
<li>In the MPI version, the densities are divided by the number of nodes. In this way, adding up contributions from all nodes, the densities from the beginning of the time step will be included correctly.</li>
<li>Subroutine <code>tstep</code> is used to propagate the wave functions to the end of the time step. Note that truncation in the exponential happens at <code>mxpact/2</code>, since the accuracy need not be as high as in the full step. For each wave function its contribution is added to the densities. The wave functions themselves do not need to be saved as they are not used for anything else.</li>
<li>After the loop, contributions from all the nodes are added up for the MPI case using subroutine <code>collect_densities</code>.</li>
<li>The densities are multiplied by one half to form the average of the values at <img class="formulaInl" alt="$ t $" src="form_52.png"/> and <img class="formulaInl" alt="$ t+\Delta t $" src="form_53.png"/>.</li>
<li>These average densities are then used to calculate the mean field at half time using subroutine <code>skyrme}</code>; also the external field is obtained for the half time using <code>extfld</code>.</li>
</ol>
</li>
<li><b> Step 3: full time step:</b> Now that the single-particle Hamiltonian has been estimated for the middle of the time step, the propagation can be carried out to the end of the time step. This is quite analogous to the half step with only three crucial differences:<ol type="1">
<li>The densities are reset to zero before the wave function loop, so the densities summed up are the purely the densities at the end of the time step,</li>
<li>the series expansion in <code>tstep</code> now uses the full <code>mxpact</code> terms, and</li>
<li>the new wave functions are copied back into <code>psi</code> to be available for the next time step.</li>
</ol>
</li>
<li><b> Step 4: Center-of-mass correction: </b> If a center-of-mass correction is desired by the user by setting <code> mrescm /=0</code>, subroutine <code>resetcm</code> is called every <code>mrescm'th</code> time step to reset the center-of-mass velocity to zero. <br  />
</li>
<li><b> Step 5: generating some output </b> At this point the time is advanced by <code>dt</code> because the physical time is now the end of the time step, and this must be printed out correctly by the following output routines. <code>tinfo</code> is called to calculate single-particle properties, total energies, and so on.</li>
<li><b> Step 6: finishing up the time step:</b> <code>tinfo</code> is called to output the calculated data, then <code>skyrme</code> and <code>extfld</code> calculate the mean field and the external field, respectively, for the end of the time step, after which the wave functions are written onto <code>wffile</code> depending on <code>mrest</code>.</li>
</ul>
<p>This ends the time loop and subroutine <code>dynamichf</code> itself. </p>

</div>
</div>
<a id="a25a35b2c3f00abafa02b49fae36b450c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25a35b2c3f00abafa02b49fae36b450c">&#9670;&nbsp;</a></span>getin_dynamic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dynamic::getin_dynamic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is a relatively simple routine that reads the input for namelist <code>dynamic</code> and prints it on standard output. If <code>texternal</code> is true, it also calls <code>getin_external</code> to read the external field parameters. </p>

</div>
</div>
<a id="aad225fa83cc6ff167d9a63f234e32ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad225fa83cc6ff167d9a63f234e32ae1">&#9670;&nbsp;</a></span>resetcm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dynamic::resetcm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine resets the center-of-mass velocity to zero. </p>
<p>The velocity, or rather the corresponding wave vector, is calculated from the current density using </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \rho(\vec r) \vec k=\frac{1}{2\I}\sum_{\alpha\in q}w_\alpha^2 \sum_s\left(\psi_\alpha^*(\vec r,s)\nabla\psi_\alpha(\vec r,s)-\psi_\alpha(\vec r,s) \nabla\psi_\alpha^*(\vec r,s)\right). \]" src="form_59.png"/>
</p>
<p> The wave functions are then multiplied by a common plane-wave phase factor <img class="formulaInl" alt="$ \exp(-\I\vec k\cdot \vec r) $" src="form_60.png"/> to give a counter boost. </p>

</div>
</div>
<a id="acc79414314504771509e8982faefe77b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc79414314504771509e8982faefe77b">&#9670;&nbsp;</a></span>tinfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dynamic::tinfo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine is used to output various pieces of information relevant especially to the dynamic mode of the code. </p>
<p>It is called at the end of the full time step and consists of the following steps:</p><ul>
<li><b> Step 1: initialization: </b> the flag <code>printnow</code> is calculated to keep track of whether this is the proper time step for a full printout (determined by <code>mprint</code>).</li>
<li><b> Step 2: twobody analysis </b> the twobody analysis is performed, but only if the calculation started as a twobody scenario. This is the simplified version which essentially only determines the fragment in case of separation. <br  />
</li>
<li><p class="startli"><b> Step 3: moments: </b> the moments of the distribution are calculated using subroutine <code>moments</code>. This includes total mass, momenta, and angular momenta. They are printed out if indicated by <code>printnow</code>, both on the large output and in the specialized files <code>dipolesfile</code>, <code>momentafile</code>, and <code>spinfile</code>. If there is an external field, the routine <code>print_extfield</code> is called to print the current expectation value of the external field.</p>
<p class="startli"><b>Note that the moments need to be calculated every time step, because some of the logic may depend on them, especially the twobody-analysis, which needs the correct c.m., for example and is calculated at every time step and on every node.</b></p>
</li>
<li><b> Step 4: single-particle quantities:</b> the single-particle energies are calculated straightforwardly as expectation values of the Hamiltonian. The routine <code>sp_properties</code> is then called to obtain the other single-particle properties like angular momenta. They are communicated between the processors. The angular momenta are written to <code>spinfile</code>.</li>
<li><b> Step 5: total energies:</b> The integrated energy <code>ehfint</code> and its contributions are calculated in <code>integ_energy</code>. The subroutine <code>sum_energy</code> is called to calculate the three-body energy and the single-particle based total energy <code>ehf</code>. The collective kinetic energy <code>ecoll</code> is computed directly here, because it is needed only in the dynamic calculations and only for output. It is defined as <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E_{\rm coll}=\frac{\hbar^2}{2m}\int \D^3r \frac{{\vec \jmath\,}^2}{\rho} \]" src="form_58.png"/>
</p>
 The energies are protocolled in <code>energiesfile</code> and on standard output.</li>
<li><b> Step 6: density output:</b> at intervals of <code>mprint</code> or in the first time step the density printer plot is generated using <code>plot_densities</code> and the binary densities are written onto <code> *.tdd </code> files using <code>write_densities</code>.</li>
<li><b> Step 7: other output: </b> in the proper <code>mprint</code> interval the single-particle state information, and the moments are printed on standard output, using also the routine <code>moment_print</code>.</li>
<li><b> Step 8: check for final separation: </b> for the twobody case it is checked whether the separation found between the two fragments is larger than the input quantity <code>rsep</code> with positive time derivative <code>rdot</code> of the separation distance, in which case the program complete twobody analysis is done and the wave functions are saved; then the job is terminated with an appropriate message. </li>
</ul>

</div>
</div>
<a id="a67d48d0e156e217e9e42654cb7189912"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d48d0e156e217e9e42654cb7189912">&#9670;&nbsp;</a></span>tstep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dynamic::tstep </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mxp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(db), dimension(:,:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>psout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In this subroutine one wave function given as the argument <code>psout</code> is stepped forward in time by the interval <code>dt</code>. </p>
<p>The method used is the expansion of the exponential time-development operator cut off at the power of <code>mxp</code>, which in practice is usually around 6. Suppressing the argument of <img class="formulaInl" alt="$ \hat h $" src="form_54.png"/> for brevity, we can write </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \hat U(t,t+\Delta t)\,\phi\approx \sum_{n=0}^m \phi^{(n)} \]" src="form_55.png"/>
</p>
<p> with </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \phi^{(0)}=\phi,\qquad \phi^{(k+1)}=\frac{-\I\,\Delta t} {\hbar c k}\,\hat h\,\phi^{(k)},\quad k=0,\ldots,m-1. \]" src="form_56.png"/>
</p>
<p>Thus the application of the polynomial to a single-particle wave function can be evaluated simply in a loop applying <img class="formulaInl" alt="$ \hat h\phi_k $" src="form_57.png"/> repeatedly and accumulating the results in wave function <code>psout</code>.</p>
<p>The argument <code>iq</code> is only necessary because <code>hpsi</code> needs information about the isospin of the wave function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iq</td><td>INTEGER, takes the isospin. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mxp</td><td>REAL(db), takes the power to which the time-development operator is expanded. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">psout</td><td>REAL(db), array, takes the wave function and returns evolved wave function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2f8a4fbc7fad45d168c880b0f7fbebf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f8a4fbc7fad45d168c880b0f7fbebf9">&#9670;&nbsp;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db) dynamic::dt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the physical time increment in units of fm/c. </p>

</div>
</div>
<a id="ab70ac1e2a79efd1c86cfefc148f67593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab70ac1e2a79efd1c86cfefc148f67593">&#9670;&nbsp;</a></span>esf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db), parameter dynamic::esf =0.0D0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this is the energy shift for the call to <code>hpsi</code>. Since it is not used in the dynamics part of the code, it is here set to the constant value of zero. </p>

</div>
</div>
<a id="a22bc0055a5dfc3e92580a8697a8ab1ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22bc0055a5dfc3e92580a8697a8ab1ef">&#9670;&nbsp;</a></span>mrescm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer dynamic::mrescm =0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>frequency of c.m. motion correction </p>

</div>
</div>
<a id="ab28058983e8491350fbbeaa9cd1c03a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab28058983e8491350fbbeaa9cd1c03a1">&#9670;&nbsp;</a></span>mxpact</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer dynamic::mxpact =6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the number of terms to be taken in the expansion of the potential </p>

</div>
</div>
<a id="a082deb2f0c47a60e4e2ef2dc1ce395e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a082deb2f0c47a60e4e2ef2dc1ce395e6">&#9670;&nbsp;</a></span>nt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer dynamic::nt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the number of the final time step to be calculated. In case of a restart this is smaller than the total number of time steps. </p>

</div>
</div>
<a id="a8f66cf733898b4e6596541c4665bb503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f66cf733898b4e6596541c4665bb503">&#9670;&nbsp;</a></span>rsep</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(db) dynamic::rsep</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the final separation distance. The calculation is stopped if there has been a reseparation into two fragments and their distance exceeds <code>rsep</code>. </p>

</div>
</div>
<a id="a1b0110fc909c9bf8bc9878b8a0afe0cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b0110fc909c9bf8bc9878b8a0afe0cf">&#9670;&nbsp;</a></span>text_timedep</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical dynamic::text_timedep</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this logical variable indicates that the external field is time-dependent and does not describe an instantaneous boost. </p>

</div>
</div>
<a id="a9c78ad5d4b68b5815c853cf157e875a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c78ad5d4b68b5815c853cf157e875a8">&#9670;&nbsp;</a></span>texternal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical dynamic::texternal =.FALSE.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this logical variable indicates that an external field is present. See module <code>External</code>. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedynamic.html">dynamic</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
